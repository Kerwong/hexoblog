{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/author.jpg","path":"images/author.jpg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/alipay_reward.jpg","path":"images/alipay_reward.jpg","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/affix.js","path":"js/src/affix.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/motion.js","path":"js/src/motion.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/hook-duoshuo.js","path":"js/src/hook-duoshuo.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/utils.js","path":"js/src/utils.js","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fastclick/LICENSE","path":"vendors/fastclick/LICENSE","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fastclick/bower.json","path":"vendors/fastclick/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fastclick/README.md","path":"vendors/fastclick/README.md","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/font-awesome/HELP-US-OUT.txt","path":"vendors/font-awesome/HELP-US-OUT.txt","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/font-awesome/bower.json","path":"vendors/font-awesome/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/jquery_lazyload/README.md","path":"vendors/jquery_lazyload/README.md","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/jquery_lazyload/CONTRIBUTING.md","path":"vendors/jquery_lazyload/CONTRIBUTING.md","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/jquery_lazyload/bower.json","path":"vendors/jquery_lazyload/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/jquery_lazyload/jquery.scrollstop.js","path":"vendors/jquery_lazyload/jquery.scrollstop.js","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/jquery_lazyload/jquery.lazyload.js","path":"vendors/jquery_lazyload/jquery.lazyload.js","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/velocity/bower.json","path":"vendors/velocity/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/velocity/velocity.min.js","path":"vendors/velocity/velocity.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/velocity/velocity.ui.min.js","path":"vendors/velocity/velocity.ui.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/velocity/velocity.ui.js","path":"vendors/velocity/velocity.ui.js","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/jquery/index.js","path":"vendors/jquery/index.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fancybox/source/blank.gif","path":"vendors/fancybox/source/blank.gif","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_loading.gif","path":"vendors/fancybox/source/fancybox_loading.gif","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_loading@2x.gif","path":"vendors/fancybox/source/fancybox_loading@2x.gif","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_overlay.png","path":"vendors/fancybox/source/fancybox_overlay.png","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_sprite.png","path":"vendors/fancybox/source/fancybox_sprite.png","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_sprite@2x.png","path":"vendors/fancybox/source/fancybox_sprite@2x.png","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fancybox/source/jquery.fancybox.css","path":"vendors/fancybox/source/jquery.fancybox.css","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fancybox/source/jquery.fancybox.pack.js","path":"vendors/fancybox/source/jquery.fancybox.pack.js","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fastclick/lib/fastclick.min.js","path":"vendors/fastclick/lib/fastclick.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fastclick/lib/fastclick.js","path":"vendors/fastclick/lib/fastclick.js","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fancybox/source/jquery.fancybox.js","path":"vendors/fancybox/source/jquery.fancybox.js","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/font-awesome/css/font-awesome.css.map","path":"vendors/font-awesome/css/font-awesome.css.map","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/font-awesome/css/font-awesome.min.css","path":"vendors/font-awesome/css/font-awesome.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/font-awesome/css/font-awesome.css","path":"vendors/font-awesome/css/font-awesome.css","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.woff2","path":"vendors/font-awesome/fonts/fontawesome-webfont.woff2","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/ua-parser-js/dist/ua-parser.pack.js","path":"vendors/ua-parser-js/dist/ua-parser.pack.js","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/ua-parser-js/dist/ua-parser.min.js","path":"vendors/ua-parser-js/dist/ua-parser.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.eot","path":"vendors/font-awesome/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/font-awesome/fonts/FontAwesome.otf","path":"vendors/font-awesome/fonts/FontAwesome.otf","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.woff","path":"vendors/font-awesome/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/velocity/velocity.js","path":"vendors/velocity/velocity.js","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"vendors/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fancybox/source/helpers/fancybox_buttons.png","path":"vendors/fancybox/source/helpers/fancybox_buttons.png","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-media.js","path":"vendors/fancybox/source/helpers/jquery.fancybox-media.js","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"vendors/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"vendors/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"vendors/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.ttf","path":"vendors/font-awesome/fonts/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.svg","path":"vendors/font-awesome/fonts/fontawesome-webfont.svg","modified":0,"renderable":1}],"Cache":[{"_id":"source/404.html","hash":"909a2b39bf012a9bb70865f9ba4569a08b165adb","modified":1476206545000},{"_id":"themes/next/.bowerrc","hash":"80e096fdc1cf912ee85dd9f7e6e77fd40cf60f10","modified":1476206545000},{"_id":"themes/next/.gitignore","hash":"c8d6a73b9e17f0f8a3716e4ada6960d3180425a6","modified":1476206546000},{"_id":"themes/next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1476206545000},{"_id":"themes/next/.hound.yml","hash":"b76daa84c9ca3ad292c78412603370a367cc2bc3","modified":1476206546000},{"_id":"themes/next/.jshintrc","hash":"9928f81bd822f6a8d67fdbc909b517178533bca9","modified":1476206546000},{"_id":"themes/next/_config.yml","hash":"55b9153e8dd8187a01cf3265a4a264e0075e51d4","modified":1476465484000},{"_id":"themes/next/.javascript_ignore","hash":"d619ee13031908cd72666e4ff652d2ea3483b1c3","modified":1476206546000},{"_id":"themes/next/README.en.md","hash":"565ba52b3825b85a9f05b41183caca7f18b741d4","modified":1476206546000},{"_id":"themes/next/gulpfile.coffee","hash":"d267332ec1461042fb16a9cb0737e1555fb4b79e","modified":1476206546000},{"_id":"themes/next/README.md","hash":"500b5606eb6a09c979d16128f8b00f4bf9bc95ac","modified":1476206546000},{"_id":"themes/next/bower.json","hash":"f89c6700a11d81e067cc97273ca6bf96cb88c8f9","modified":1476206546000},{"_id":"themes/next/package.json","hash":"63e9c0f1dd9e5d7f51b4ae383981ef939a2ed45d","modified":1476206546000},{"_id":"source/_posts/.Spring-与-MyBatis-的集成详解.md.un~","hash":"91c436399db6fecd9d3a373640c3ab1ed50de80d","modified":1476381056000},{"_id":"source/_posts/Spring-与-MyBatis-的集成详解.md","hash":"baa28af11a37f702b9a350b9a4331b529327a24c","modified":1476459023000},{"_id":"source/_posts/hello-world.md","hash":"8a02477044e2b77f1b262da2c48c01429e4a32e4","modified":1476206545000},{"_id":"source/_posts/漫谈-JDBC-以及与-Spring-之整合.md","hash":"c872626b71a95d5c5f879bc692d6d76967dbc1f7","modified":1476517083000},{"_id":"source/categories/index.md","hash":"fd91332837d727cba1f019e70380f5a07a77f42c","modified":1476206545000},{"_id":"source/_posts/new-article.md","hash":"18c83e35ec6fbd574dac95edb6d70257086050b1","modified":1476206545000},{"_id":"source/tags/index-1.md","hash":"f432b5d450e0be188b218b2a25d4c44ccee62507","modified":1476206545000},{"_id":"source/tags/index.md","hash":"98b58e6bf7e6a473272ccd06f42529dccbfb0fee","modified":1476206545000},{"_id":"themes/next/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1476206545000},{"_id":"themes/next/.git/config","hash":"ca83ce520f770c3104c997d323b9f293dd920073","modified":1476206545000},{"_id":"themes/next/.git/index","hash":"7af76866cbf7d26bb6627c02f7aba4568b31199a","modified":1476518137000},{"_id":"themes/next/.git/packed-refs","hash":"5216a79fb99bdf08c5d7f588c2ae5dd48d4b1314","modified":1476206546000},{"_id":"themes/next/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1476206545000},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"5ab257af816986cd0e53f9527a92d5934ac70ae9","modified":1476206546000},{"_id":"themes/next/.github/ISSUE_TEMPLATE.md","hash":"c2024ded82143807c28a299c5fe6b927ef3525ff","modified":1476206546000},{"_id":"themes/next/languages/de.yml","hash":"786afba25cfc98845a20d9901823ebeebcd1cbbf","modified":1476206546000},{"_id":"themes/next/languages/en.yml","hash":"f03799cbdb5a33064ead080bcac4baca1f6bc5f9","modified":1476206546000},{"_id":"themes/next/languages/default.yml","hash":"9db835c0543ade5a89bc80ec5a898203227cf3d8","modified":1476206546000},{"_id":"themes/next/languages/fr-FR.yml","hash":"1a084623c39de74301f3e92f9388a3a815a542ca","modified":1476206546000},{"_id":"themes/next/languages/ko.yml","hash":"ce8b047c89daae77c03482fc76f16ffec6bdbf2d","modified":1476206546000},{"_id":"themes/next/languages/ja.yml","hash":"a2c7b6301b5474aab798946fb700289df237c3cf","modified":1476206546000},{"_id":"themes/next/languages/pt-BR.yml","hash":"462aa865ca3d479bcf6b363cba61247b50f230ff","modified":1476206546000},{"_id":"themes/next/languages/id.yml","hash":"147c01e41b931085ad14250fa900c2249dcbbdd7","modified":1476206546000},{"_id":"themes/next/languages/pt.yml","hash":"ca239b39bf65c9462e59d51b12f0fe566d453197","modified":1476206546000},{"_id":"themes/next/languages/ru.yml","hash":"cc7b964a46587aea0e57b0a5269d8fd25570858e","modified":1476206546000},{"_id":"themes/next/languages/zh-Hans.yml","hash":"bea452bc49aed171a210d09bd6cddc4e846ea8ab","modified":1476206546000},{"_id":"themes/next/languages/zh-hk.yml","hash":"519ab3d817ec3bc5bfc91159c494b6b3c170bea7","modified":1476206546000},{"_id":"themes/next/layout/_layout.swig","hash":"cfb04083ccde8c0a7749c1a4ac39327f69c84863","modified":1476206546000},{"_id":"themes/next/languages/zh-tw.yml","hash":"6b1f345aaefc13e6723dc8a6741b59ac05c20dfd","modified":1476206546000},{"_id":"themes/next/layout/archive.swig","hash":"b5b59d70fc1563f482fa07afd435752774ad5981","modified":1476206546000},{"_id":"themes/next/layout/page.swig","hash":"8019d02232a6dd1a665b6a4d2daef8e5dd2f0049","modified":1476206546000},{"_id":"themes/next/layout/post.swig","hash":"e2e512142961ddfe77eba29eaa88f4a2ee43ae18","modified":1476206546000},{"_id":"themes/next/layout/index.swig","hash":"427d0b95b854e311ae363088ab39a393bf8fdc8b","modified":1476206546000},{"_id":"themes/next/scripts/merge-configs.js","hash":"0c56be2e85c694247cfa327ea6d627b99ca265e8","modified":1476206546000},{"_id":"themes/next/layout/category.swig","hash":"6422d196ceaff4220d54b8af770e7e957f3364ad","modified":1476206546000},{"_id":"themes/next/layout/tag.swig","hash":"07cf49c49c39a14dfbe9ce8e7d7eea3d4d0a4911","modified":1476206546000},{"_id":"themes/next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1476206546000},{"_id":"themes/next/source/.DS_Store","hash":"495dc0d217dbc3e7cb0c015a4aa9af3e7011d37f","modified":1476283371000},{"_id":"themes/next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1476206546000},{"_id":"themes/next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1476206546000},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1476206546000},{"_id":"themes/next/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1476206545000},{"_id":"themes/next/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1476206545000},{"_id":"themes/next/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1476206545000},{"_id":"themes/next/.git/logs/HEAD","hash":"8257a49fc3807ace3b92dca29f828382ee48ffc8","modified":1476206545000},{"_id":"themes/next/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1476206545000},{"_id":"themes/next/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1476206545000},{"_id":"themes/next/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1476206545000},{"_id":"themes/next/.git/hooks/prepare-commit-msg.sample","hash":"2b6275eda365cad50d167fe3a387c9bc9fedd54f","modified":1476206545000},{"_id":"themes/next/.git/hooks/pre-commit.sample","hash":"36aed8976dcc08b5076844f0ec645b18bc37758f","modified":1476206545000},{"_id":"themes/next/.git/hooks/pre-rebase.sample","hash":"5885a56ab4fca8075a05a562d005e922cde9853b","modified":1476206545000},{"_id":"themes/next/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1476206545000},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"bc311e9f4333188da5c9c721ae467ba14410d5b2","modified":1476206546000},{"_id":"themes/next/layout/_macro/post.swig","hash":"ea40d388ae190e2228cbe54f054be621e3fa061c","modified":1476206546000},{"_id":"themes/next/layout/_macro/reward.swig","hash":"37e5b7c42ec17b9b6b786c5512bcc481a21c974e","modified":1476206546000},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"084867c289c95c5ebc18435a3b2092091bb8e2ba","modified":1476206546000},{"_id":"themes/next/layout/_partials/footer.swig","hash":"4fe588ff8ba8587885c2936db2df490774f89e10","modified":1476206546000},{"_id":"themes/next/layout/_macro/wechat-subscriber.swig","hash":"14e785adeb0e671ba0ff9a553e6f0d8def6c670c","modified":1476206546000},{"_id":"themes/next/layout/_partials/duoshuo-hot-articles.swig","hash":"5d4638c46aef65bf32a01681495b62416ccc98db","modified":1476206546000},{"_id":"themes/next/layout/_partials/comments.swig","hash":"58fd826ca75b0cbc48b61a58da4b841e2fa34403","modified":1476206546000},{"_id":"themes/next/layout/_partials/head.swig","hash":"06b6604176367af52587312e2575b52ecf53c3d9","modified":1476206546000},{"_id":"themes/next/layout/_partials/header.swig","hash":"eb028685cb3c329537bbced06c063d23e6a33817","modified":1476206546000},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"9e8e21d194ef44d271b1cca0bc1448c14d7edf4f","modified":1476206546000},{"_id":"themes/next/layout/_partials/search.swig","hash":"011b9d6c9f0a2f4654908ea20b9391f9b7981271","modified":1476206546000},{"_id":"themes/next/layout/_scripts/baidu-push.swig","hash":"82d060fe055d6e423bbc9199f82dfe5c68e74779","modified":1476206546000},{"_id":"themes/next/layout/_scripts/lean-analytics.swig","hash":"7bc17dceb699b020a0d9eebd68a3ce6b5b2f4b30","modified":1476206546000},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"766b2bdda29523ed6cd8d7aa197f996022f8fd94","modified":1476206546000},{"_id":"themes/next/layout/_scripts/boostrap.swig","hash":"03aaebe9d50f6acb007ec38cc04acd1cfceb404d","modified":1476206546000},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"0b91cadecead8e0b5211cc42b085998d94af503a","modified":1476206546000},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"535fc542781021c4326dec24d8495cbb1387634a","modified":1476206546000},{"_id":"themes/next/scripts/tags/full-image.js","hash":"3acce36db0feb11a982c6c799aa6b6b47df2827c","modified":1476206546000},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"49252824cd53184dc9b97b2f2d87ff28e1b3ef27","modified":1476206546000},{"_id":"themes/next/source/css/main.styl","hash":"20702c48d6053c92c5bcdbc68e8d0ef1369848a0","modified":1476206546000},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1476206546000},{"_id":"themes/next/source/images/author.jpg","hash":"83801b11c32b29a062bb44ecda657198f17462dd","modified":1476206546000},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1476206546000},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1476206546000},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1476206546000},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1476206546000},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1476206546000},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1476206546000},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1476206546000},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1476206546000},{"_id":"themes/next/source/images/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1476206546000},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1476206546000},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1476206546000},{"_id":"themes/next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1476206546000},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1476206546000},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1476206546000},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1476206546000},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1476206546000},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1476206546000},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1476206546000},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1476206546000},{"_id":"themes/next/source/images/alipay_reward.jpg","hash":"e1c02df885f78d2a81130c1b75edb888305f89b1","modified":1476206546000},{"_id":"themes/next/.git/refs/heads/master","hash":"c2dfdb1c9763f4b704310934baa32097241d6172","modified":1476206546000},{"_id":"themes/next/.git/objects/3c/cd58d1364b0f03292d7cb3c20d001d744150ac","hash":"9a41600f6b701d6a64407b52e447368828417ba0","modified":1476206545000},{"_id":"themes/next/.git/objects/23/75ea60405cfc4413dfc3d8f379456e2a066dc4","hash":"f256879db2f3b78d142b146f63c408ab32e73ceb","modified":1476206545000},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"7ce76358411184482bb0934e70037949dd0da8ca","modified":1476206546000},{"_id":"themes/next/layout/_partials/search/tinysou.swig","hash":"eefe2388ff3d424694045eda21346989b123977c","modified":1476206546000},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"ff5523d5dacaa77a55a24e50e6e6530c3b98bfad","modified":1476206546000},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"959b7e04a96a5596056e4009b73b6489c117597e","modified":1476206546000},{"_id":"themes/next/layout/_partials/share/jiathis.swig","hash":"63315fcf210799f894208c9f512737096df84962","modified":1476206546000},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"23e23dc0f76ef3c631f24c65277adf7ea517b383","modified":1476206546000},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"1f1107468aaf03f7d0dcd7eb2b653e2813a675b4","modified":1476206546000},{"_id":"themes/next/layout/_partials/share/duoshuo_share.swig","hash":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1476206546000},{"_id":"themes/next/layout/_scripts/third-party/analytics.swig","hash":"0a89c04055bade7baa5962f1d5aefe438d83a244","modified":1476206546000},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"069d1357c717572256e5cdee09574ebce529cbae","modified":1476206546000},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1476206546000},{"_id":"themes/next/layout/_scripts/third-party/comments.swig","hash":"907b931d775d32405d02a25b3b0a3ac03bf804d0","modified":1476206546000},{"_id":"themes/next/layout/_scripts/third-party/lean-analytics.swig","hash":"92dc60821307fc9769bea9b2d60adaeb798342af","modified":1476206546000},{"_id":"themes/next/layout/_scripts/third-party/mathjax.swig","hash":"5bafc33f57508d1d04a9930165240f6e9efa8d6d","modified":1476206546000},{"_id":"themes/next/layout/_scripts/third-party/localsearch.swig","hash":"60a51a33416e2b86ac9fbefc86b80f2f5f60e1c0","modified":1476206546000},{"_id":"themes/next/layout/_scripts/third-party/tinysou.swig","hash":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1476206546000},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1476206546000},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"715d5b40dc52f319fe4bff0325beb874774d9bd9","modified":1476206546000},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"78a83c38f69a8747bb74e420e6c9eeef1ea76525","modified":1476206546000},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"c8d35a6b9e3bff6d8fdb66de853065af9d37562d","modified":1476206546000},{"_id":"themes/next/source/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1476206546000},{"_id":"themes/next/source/css/_variables/base.styl","hash":"9a13073ae239ac0c8a35c5d8cf77b706c10f58c2","modified":1476206546000},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"3ead77befa064d6327dc7afd0a5af7be59a5f196","modified":1476206546000},{"_id":"themes/next/source/js/src/bootstrap.js","hash":"39bf93769d9080fa01a9a875183b43198f79bc19","modified":1476206546000},{"_id":"themes/next/source/js/src/motion.js","hash":"269414e84df544a4ccb88519f6abae4943db3c67","modified":1476206546000},{"_id":"themes/next/source/js/src/post-details.js","hash":"2038f54e289b6da5def09689e69f623187147be5","modified":1476206546000},{"_id":"themes/next/source/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1476206546000},{"_id":"themes/next/source/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1476206546000},{"_id":"themes/next/source/vendors/fastclick/.bower.json","hash":"93ebd5b35e632f714dcf1753e1f6db77ec74449b","modified":1476206546000},{"_id":"themes/next/source/js/src/utils.js","hash":"e5cb720894c4bc28ca8f10b33df127fb394018d9","modified":1476206546000},{"_id":"themes/next/source/vendors/fancybox/.gitattributes","hash":"2db21acfbd457452462f71cc4048a943ee61b8e0","modified":1476206546000},{"_id":"themes/next/source/vendors/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1476206546000},{"_id":"themes/next/source/vendors/fastclick/bower.json","hash":"13379463c7463b4b96d13556b46faa4cc38d81e6","modified":1476206546000},{"_id":"themes/next/source/vendors/fancybox/.bower.json","hash":"cc40a9b11e52348e554c84e4a5c058056f6b7aeb","modified":1476206546000},{"_id":"themes/next/source/vendors/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1476206546000},{"_id":"themes/next/source/vendors/fastclick/README.md","hash":"1decd8e1adad2cd6db0ab50cf56de6035156f4ea","modified":1476206546000},{"_id":"themes/next/source/vendors/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1476206546000},{"_id":"themes/next/source/vendors/font-awesome/.bower.json","hash":"7da985a99674e54f514d4fd9fcd3bcea6e7e41d5","modified":1476206546000},{"_id":"themes/next/source/vendors/font-awesome/HELP-US-OUT.txt","hash":"69a4c537d167b68a0ccf1c6febd138aeffca60d6","modified":1476206546000},{"_id":"themes/next/source/vendors/jquery/.bower.json","hash":"91745c2cc6c946c7275f952b2b0760b880cea69e","modified":1476206546000},{"_id":"themes/next/source/vendors/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1476206546000},{"_id":"themes/next/source/vendors/jquery_lazyload/README.md","hash":"895d50fa29759af7835256522e9dd7dac597765c","modified":1476206546000},{"_id":"themes/next/source/vendors/jquery_lazyload/CONTRIBUTING.md","hash":"4891864c24c28efecd81a6a8d3f261145190f901","modified":1476206546000},{"_id":"themes/next/source/vendors/jquery_lazyload/.bower.json","hash":"b7638afc93e9cd350d0783565ee9a7da6805ad8e","modified":1476206546000},{"_id":"themes/next/source/vendors/jquery_lazyload/bower.json","hash":"65bc85d12197e71c40a55c0cd7f6823995a05222","modified":1476206546000},{"_id":"themes/next/source/vendors/velocity/.bower.json","hash":"05f960846f1c7a93dab1d3f9a1121e86812e8c88","modified":1476206546000},{"_id":"themes/next/source/vendors/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1476206546000},{"_id":"themes/next/source/vendors/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1476206546000},{"_id":"themes/next/source/vendors/velocity/bower.json","hash":"2ec99573e84c7117368beccb9e94b6bf35d2db03","modified":1476206546000},{"_id":"themes/next/source/vendors/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1476206546000},{"_id":"themes/next/source/vendors/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1476206546000},{"_id":"themes/next/source/vendors/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1476206546000},{"_id":"themes/next/.git/objects/79/f0c405843bd9149208464903f73371eee878fc","hash":"16e2649d312add1a92c04ea85b63bfb9a0c114e7","modified":1476206545000},{"_id":"themes/next/source/vendors/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1476206546000},{"_id":"themes/next/.git/objects/pack/pack-2e8b94015733e86ff63474e1cca77d2f61b32531.idx","hash":"b4ac10fe9a42e9fed7e7f882a6aa67d94aed3b9a","modified":1476206545000},{"_id":"themes/next/.git/logs/refs/heads/master","hash":"8257a49fc3807ace3b92dca29f828382ee48ffc8","modified":1476206545000},{"_id":"themes/next/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1476206546000},{"_id":"themes/next/layout/_scripts/third-party/analytics/baidu-analytics.swig","hash":"7c43d66da93cde65b473a7d6db2a86f9a42647d6","modified":1476206546000},{"_id":"themes/next/layout/_scripts/third-party/analytics/busuanzi-counter.swig","hash":"4fcbf57c4918528ab51d3d042cff92cf5aefb599","modified":1476206546000},{"_id":"themes/next/layout/_scripts/third-party/analytics/cnzz-analytics.swig","hash":"8160b27bee0aa372c7dc7c8476c05bae57f58d0f","modified":1476206546000},{"_id":"themes/next/layout/_scripts/third-party/analytics/google-analytics.swig","hash":"30a23fa7e816496fdec0e932aa42e2d13098a9c2","modified":1476206546000},{"_id":"themes/next/layout/_scripts/third-party/analytics/facebook-sdk.swig","hash":"394d008e5e94575280407ad8a1607a028026cbc3","modified":1476206546000},{"_id":"themes/next/layout/_scripts/third-party/analytics/tencent-analytics.swig","hash":"3658414379e0e8a34c45c40feadc3edc8dc55f88","modified":1476206546000},{"_id":"themes/next/layout/_scripts/third-party/comments/disqus.swig","hash":"bff3b18f56175c53f3bc6d733166c4d998e08732","modified":1476206546000},{"_id":"themes/next/layout/_scripts/third-party/comments/duoshuo.swig","hash":"696666141cdd204fd8818ac2ad18f05e320f8587","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"b49efc66bd055a2d0be7deabfcb02ee72a9a28c8","modified":1476518126000},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"10994990d6e0b4d965a728a22cf7f6ee29cae9f6","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"0dfb4b3ba3180d7285e66f270e1d3fa0f132c3d2","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"711c8830886619d4f4a0598b0cde5499dce50c62","modified":1476206546000},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"2186be20e317505cd31886f1291429cc21f76703","modified":1476206546000},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"5304f99581da3a31de3ecec959b7adf9002fde83","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/tag-cloud.styl","hash":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1476206546000},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"64f5d56c08d74a338813df1265580ca0cbf0190b","modified":1476206546000},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"013619c472c7e4b08311c464fcbe9fcf5edde603","modified":1476206546000},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"54c90cf7bdbf5c596179d8dae6e671bad1292662","modified":1476206546000},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"5ae7906dc7c1d9468c7f4b4a6feddddc555797a1","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"b0dcca862cd0cc6e732e33d975b476d744911742","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"c2d079788d6fc2e9a191ccdae94e50d55bf849dc","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"9a5581a770af8964064fef7afd3e16963e45547f","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"8829bc556ca38bfec4add4f15a2f028092ac6d46","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"c2c6c4f6434b4f94aac2af5861cd769427f0ee10","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"a0e2030a606c934fb2c5c7373aaae04a1caac4c5","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"4303776991ef28f5742ca51c7dffe6f12f0acf34","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"7b206cd8921bc042f8e37a74aea1abc8a5ec8ab4","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"d09280e5b79f3b573edb30f30c7a5f03ac640986","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Pisces/_posts.styl","hash":"2f878213cb24c5ddc18877f6d15ec5c5f57745ac","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"0efa036a15c18f5abb058b7c0fad1dd9ac5eed4c","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"d4b7bd610ca03dbb2f5b66631c0e84a79fb4660b","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"be22ad34f546a07f6d56b424338cdd898683eea4","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Pisces/_full-image.styl","hash":"938d39eedc6e3d33918c1145a5bf1e79991d3fcf","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"1b10ba2d3ad0c063c418dc94a0b7e0db4b342c53","modified":1476206546000},{"_id":"themes/next/source/js/src/schemes/pisces.js","hash":"7506e7490c69a200831393c38d25e91c156bd471","modified":1476206546000},{"_id":"themes/next/source/vendors/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1476206546000},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1476206546000},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1476206546000},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1476206546000},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1476206546000},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1476206546000},{"_id":"themes/next/source/vendors/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1476206546000},{"_id":"themes/next/source/vendors/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1476206546000},{"_id":"themes/next/source/vendors/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1476206546000},{"_id":"themes/next/source/vendors/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1476206546000},{"_id":"themes/next/source/vendors/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1476206546000},{"_id":"themes/next/source/vendors/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1476206546000},{"_id":"themes/next/source/vendors/font-awesome/css/font-awesome.min.css","hash":"05ea25bc9b3ac48993e1fee322d3bc94b49a6e22","modified":1476206546000},{"_id":"themes/next/source/vendors/font-awesome/css/font-awesome.css","hash":"3b87c2560832748cd06f9bfd2fd6ea8edbdae8c7","modified":1476206546000},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.woff2","hash":"574ea2698c03ae9477db2ea3baf460ee32f1a7ea","modified":1476206546000},{"_id":"themes/next/source/vendors/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1476206546000},{"_id":"themes/next/source/vendors/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1476206546000},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.eot","hash":"b3c2f08e73320135b69c23a3908b87a12053a2f6","modified":1476206546000},{"_id":"themes/next/source/vendors/font-awesome/fonts/FontAwesome.otf","hash":"0112e96f327d413938d37c1693806f468ffdbace","modified":1476206546000},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.woff","hash":"507970402e328b2baeb05bde73bf9ded4e2c3a2d","modified":1476206546000},{"_id":"themes/next/source/vendors/velocity/velocity.js","hash":"e63dc7cea055ca60a95d286f32349d88b10c5a4d","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"96f32ea6c3265a3889e6abe57587f6e2a2a40dfb","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"e533b70f281275357fce083422e5d26bbf69d543","modified":1476206546000},{"_id":"themes/next/.git/logs/refs/remotes/origin/HEAD","hash":"8257a49fc3807ace3b92dca29f828382ee48ffc8","modified":1476206545000},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"8994ffcce84deac0471532f270f97c44fea54dc0","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"ae1ca14e51de67b07dba8f61ec79ee0e2e344574","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"90f8f9706cd7fe829cf06e9959a65fd3f8b994fa","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"c890ce7fe933abad7baf39764a01894924854e92","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"6c00f6e0978f4d8f9a846a15579963728aaa6a17","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"7778920dd105fa4de3a7ab206eeba30b1a7bac45","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"49c2b2c14a1e7fcc810c6be4b632975d0204c281","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"3c46efd6601e268093ce6d7b1471d18501878f0d","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"2cdc094ecf907a02fce25ad4a607cd5c40da0f2b","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"8fae54591877a73dff0b29b2be2e8935e3c63575","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"b25132fe6a7ad67059a2c3afc60feabb479bdd75","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"d543d1377c1f61b70e3adb6da0eb12797552e5f2","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/post/post-more-link.styl","hash":"15063d79b5befc21820baf05d6f20cc1c1787477","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"e792c8dc41561c96d128e9b421187f1c3dc978a0","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"cbca4842a54950e2934b3b8f3cd940f122111aef","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"2e7ec9aaa3293941106b1bdd09055246aa3c3dc6","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"4eb18b12fa0ea6c35925d9a64f64e2a7dae8c7fd","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"963105a531403d7aad6d9e5e23e3bfabb8ec065a","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"920343e41c124221a17f050bbb989494d44f7a24","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"c44f6a553ec7ea5508f2054a13be33a62a15d3a9","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"10251257aceecb117233c9554dcf8ecfef8e2104","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"9486ddd2cb255227db102d09a7df4cae0fabad72","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"45fa7193435a8eae9960267438750b4c9fa9587f","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"234facd038f144bd0fe09a31ed1357c5d74c517f","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"2d3abbc85b979a648e0e579e45f16a6eba49d1e7","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"7690b9596ec3a49befbe529a5a2649abec0faf76","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"3623e7fa4324ec1307370f33d8f287a9e20a5578","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"618f73450cf541f88a4fddc3d22898aee49d105d","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"8e66c2635d48e11de616bb29c4b1323698eebc0a","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/third-party/duoshuo.styl","hash":"2340dd9b3202c61d73cc708b790fac5adddbfc7f","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/third-party/baidushare.styl","hash":"93b08815c4d17e2b96fef8530ec1f1064dede6ef","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"637c6b32c58ecf40041be6e911471cd82671919b","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/third-party/jiathis.styl","hash":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"3afc459442c132c480d1d832f1a872f1070bb048","modified":1476206546000},{"_id":"themes/next/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"b03f891883446f3a5548b7cc90d29c77e62f1053","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"8b8e8cbce98a9296c8fd77f512ae85d945f65d40","modified":1476206546000},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"8b8e8cbce98a9296c8fd77f512ae85d945f65d40","modified":1476206546000},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1476206546000},{"_id":"themes/next/source/vendors/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1476206546000},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1476206546000},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1476206546000},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1476206546000},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1476206546000},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.ttf","hash":"27cf1f2ec59aece6938c7bb2feb0e287ea778ff9","modified":1476206546000},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.svg","hash":"2b3c8ba7008cc014d8fb37abc6f9f49aeda83824","modified":1476206546000},{"_id":"themes/next/.git/objects/pack/pack-2e8b94015733e86ff63474e1cca77d2f61b32531.pack","hash":"176caecf58a7642d2cb566b68fd94df1f703cbbf","modified":1476206545000},{"_id":"public/404.html","hash":"ef1d6148c21fa2bfb1def90c9713fbda98b1f499","modified":1476467760081},{"_id":"public/categories/index.html","hash":"8e401f33228c846e31d7c30ba3d522ac6c1d2b9e","modified":1476467760081},{"_id":"public/tags/index-1.html","hash":"58ece5457b6d1f10f689427cd296b55c486eebee","modified":1476467760082},{"_id":"public/tags/index.html","hash":"096c176aa3a03bb4d36013ab1088b132af514701","modified":1476467760082},{"_id":"public/categories/day/index.html","hash":"7a8727f1439cc3057fb251591c50027b5153c70b","modified":1476467760082},{"_id":"public/tags/test/index.html","hash":"ec6285b8f9e4a3a0bc1bfc8d6554205ffefc5411","modified":1476467760082},{"_id":"public/tags/markdown/index.html","hash":"9699bd550933a0a242b00bc445c033f8473883cf","modified":1476467760083},{"_id":"public/2016/10/Spring-与-MyBatis-的集成详解/index.html","hash":"fc6e72f001bcb33ff51a9c7b894fc8c578fa5068","modified":1476467760083},{"_id":"public/2016/10/hello-world/index.html","hash":"47dd86940ea48357c9a32f77dd4bdc88915701b4","modified":1476467760083},{"_id":"public/2016/10/new-article/index.html","hash":"6a1ad34e6ccc7c190f12eb4a371ced246ec6d887","modified":1476467760083},{"_id":"public/archives/index.html","hash":"1305d1a5d1adae871b38a4ce890f01188af35821","modified":1476467760083},{"_id":"public/archives/2016/index.html","hash":"183248fb5d2c9e65f1053547d3072de0b1e9c3fb","modified":1476467760083},{"_id":"public/archives/2016/10/index.html","hash":"544a4da0ad793df7fe33922a6b20c243b82e7778","modified":1476467760083},{"_id":"public/index.html","hash":"25606694f88b88a0a73bf7414ff2803f6998aff2","modified":1476467760083},{"_id":"public/tags/Spring/index.html","hash":"91f42e6dbadb2f1249f2682d0fe674adcc9ba2aa","modified":1476467760082},{"_id":"public/tags/JDBC-Spring/index.html","hash":"72d2390ed0d535b014020efc224acd7685d69d7d","modified":1476464116325},{"_id":"public/2016/10/漫谈-JDBC-以及与-Spring-之整合/index.html","hash":"d04290c92193301bab88e873eb6cb538d329667e","modified":1476518089162},{"_id":"public/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1476464116338},{"_id":"public/images/author.jpg","hash":"83801b11c32b29a062bb44ecda657198f17462dd","modified":1476464116339},{"_id":"public/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1476464116339},{"_id":"public/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1476464116339},{"_id":"public/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1476464116339},{"_id":"public/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1476464116340},{"_id":"public/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1476464116340},{"_id":"public/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1476464116340},{"_id":"public/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1476464116340},{"_id":"public/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1476464116340},{"_id":"public/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1476464116340},{"_id":"public/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1476464116340},{"_id":"public/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1476464116340},{"_id":"public/vendors/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1476464116341},{"_id":"public/vendors/font-awesome/HELP-US-OUT.txt","hash":"69a4c537d167b68a0ccf1c6febd138aeffca60d6","modified":1476464116341},{"_id":"public/vendors/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1476464116341},{"_id":"public/vendors/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1476464116341},{"_id":"public/vendors/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1476464116341},{"_id":"public/vendors/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1476464116341},{"_id":"public/vendors/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1476464116341},{"_id":"public/vendors/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1476464116341},{"_id":"public/vendors/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1476464116341},{"_id":"public/vendors/font-awesome/fonts/fontawesome-webfont.woff2","hash":"574ea2698c03ae9477db2ea3baf460ee32f1a7ea","modified":1476464116341},{"_id":"public/vendors/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1476464116341},{"_id":"public/images/alipay_reward.jpg","hash":"e1c02df885f78d2a81130c1b75edb888305f89b1","modified":1476464117211},{"_id":"public/vendors/font-awesome/fonts/fontawesome-webfont.eot","hash":"b3c2f08e73320135b69c23a3908b87a12053a2f6","modified":1476464117212},{"_id":"public/vendors/font-awesome/fonts/FontAwesome.otf","hash":"0112e96f327d413938d37c1693806f468ffdbace","modified":1476464117223},{"_id":"public/vendors/font-awesome/fonts/fontawesome-webfont.woff","hash":"507970402e328b2baeb05bde73bf9ded4e2c3a2d","modified":1476464117223},{"_id":"public/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1476464117229},{"_id":"public/js/src/bootstrap.js","hash":"39bf93769d9080fa01a9a875183b43198f79bc19","modified":1476464117229},{"_id":"public/js/src/motion.js","hash":"269414e84df544a4ccb88519f6abae4943db3c67","modified":1476464117229},{"_id":"public/js/src/post-details.js","hash":"2038f54e289b6da5def09689e69f623187147be5","modified":1476464117229},{"_id":"public/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1476464117229},{"_id":"public/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1476464117229},{"_id":"public/js/src/utils.js","hash":"e5cb720894c4bc28ca8f10b33df127fb394018d9","modified":1476464117229},{"_id":"public/vendors/fastclick/bower.json","hash":"4dcecf83afddba148464d5339c93f6d0aa9f42e9","modified":1476464117229},{"_id":"public/vendors/fastclick/README.html","hash":"da3c74d484c73cc7df565e8abbfa4d6a5a18d4da","modified":1476464117229},{"_id":"public/vendors/font-awesome/bower.json","hash":"64394a2a9aa00f8e321d8daa5e51a420f0e96dad","modified":1476464117229},{"_id":"public/vendors/jquery_lazyload/README.html","hash":"bde24335f6bc09d8801c0dcd7274f71b466552bd","modified":1476464117229},{"_id":"public/vendors/jquery_lazyload/CONTRIBUTING.html","hash":"a6358170d346af13b1452ac157b60505bec7015c","modified":1476464117229},{"_id":"public/vendors/jquery_lazyload/bower.json","hash":"ae3c3b61e6e7f9e1d7e3585ad854380ecc04cf53","modified":1476464117230},{"_id":"public/vendors/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1476464117230},{"_id":"public/vendors/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1476464117230},{"_id":"public/vendors/velocity/bower.json","hash":"0ef14e7ccdfba5db6eb3f8fc6aa3b47282c36409","modified":1476464117230},{"_id":"public/vendors/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1476464117230},{"_id":"public/js/src/schemes/pisces.js","hash":"7506e7490c69a200831393c38d25e91c156bd471","modified":1476464117230},{"_id":"public/vendors/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1476464117230},{"_id":"public/vendors/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1476464117230},{"_id":"public/vendors/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1476464117230},{"_id":"public/vendors/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1476464117231},{"_id":"public/vendors/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1476464117231},{"_id":"public/vendors/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1476464117231},{"_id":"public/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1476464117231},{"_id":"public/vendors/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1476464117231},{"_id":"public/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1476464117231},{"_id":"public/css/main.css","hash":"66799ce82643e6eed1fc7dc25784d78ac8188585","modified":1476464117232},{"_id":"public/vendors/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1476464117232},{"_id":"public/vendors/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1476464117232},{"_id":"public/vendors/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1476464117232},{"_id":"public/vendors/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1476464117232},{"_id":"public/vendors/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1476464117232},{"_id":"public/vendors/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1476464117232},{"_id":"public/vendors/font-awesome/css/font-awesome.min.css","hash":"05ea25bc9b3ac48993e1fee322d3bc94b49a6e22","modified":1476464117232},{"_id":"public/vendors/font-awesome/css/font-awesome.css","hash":"3b87c2560832748cd06f9bfd2fd6ea8edbdae8c7","modified":1476464117232},{"_id":"public/vendors/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1476464117232},{"_id":"public/vendors/font-awesome/fonts/fontawesome-webfont.ttf","hash":"27cf1f2ec59aece6938c7bb2feb0e287ea778ff9","modified":1476464117232},{"_id":"public/vendors/font-awesome/fonts/fontawesome-webfont.svg","hash":"2b3c8ba7008cc014d8fb37abc6f9f49aeda83824","modified":1476464117266},{"_id":"themes/next/._config.yml.un~","hash":"aa296a48971b0ecba60e57e190bf02f246f55c2f","modified":1476465484000},{"_id":"public/tags/JDBC/index.html","hash":"9f431eb9232c7f5033a2ec60c907e6dd50330ec4","modified":1476467760084},{"_id":"themes/next/source/css/_common/components/.back-to-top.styl.un~","hash":"da26ad71c1baa05d04f9001fbc8648986569bf2b","modified":1476518126000}],"Category":[{"name":"day","_id":"ciua0m28a00080inu6qh3b9s7"}],"Data":[],"Page":[{"_content":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"robots\" content=\"all\" />\n  <meta name=\"robots\" content=\"index,follow\"/>\n</head>\n<body>\n\n<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\"\n        charset=\"utf-8\" homePageUrl=\"your site url \"\n        homePageName=\"回到我的主页\">\n</script>\n\n</body>\n</html>","source":"404.html","raw":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"robots\" content=\"all\" />\n  <meta name=\"robots\" content=\"index,follow\"/>\n</head>\n<body>\n\n<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\"\n        charset=\"utf-8\" homePageUrl=\"your site url \"\n        homePageName=\"回到我的主页\">\n</script>\n\n</body>\n</html>","date":"2016-10-11T17:22:25.000Z","updated":"2016-10-11T17:22:25.000Z","path":"404.html","title":"","comments":1,"layout":"page","_id":"ciua0m26300000inujfxygx9l","content":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n  <meta name=\"robots\" content=\"all\">\n  <meta name=\"robots\" content=\"index,follow\">\n</head>\n<body>\n\n<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homepageurl=\"your site url \" homepagename=\"回到我的主页\">\n</script>\n\n</body>\n</html>","excerpt":"","more":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"robots\" content=\"all\" />\n  <meta name=\"robots\" content=\"index,follow\"/>\n</head>\n<body>\n\n<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\"\n        charset=\"utf-8\" homePageUrl=\"your site url \"\n        homePageName=\"回到我的主页\">\n</script>\n\n</body>\n</html>"},{"layout":"categories","title":"categories","_content":"","source":"categories/index.md","raw":"---\nlayout: categories\ntitle: categories\n---\n","date":"2016-10-11T17:22:25.000Z","updated":"2016-10-11T17:22:25.000Z","path":"categories/index.html","comments":1,"_id":"ciua0m27t00020inuf5clwvth","content":"","excerpt":"","more":""},{"title":"tags","date":"2016-10-11T15:57:08.000Z","type":"tags","comments":0,"_content":"\n## Hello\n`tags` this is **test page**\n","source":"tags/index-1.md","raw":"---\ntitle: tags\ndate: 2016-10-11 23:57:08\ntype: \"tags\"\ncomments: false\n---\n\n## Hello\n`tags` this is **test page**\n","updated":"2016-10-11T17:22:25.000Z","path":"tags/index-1.html","layout":"page","_id":"ciua0m2d5000g0inu6a3mi6qh","content":"<h2 id=\"Hello\"><a href=\"#Hello\" class=\"headerlink\" title=\"Hello\"></a>Hello</h2><p><code>tags</code> this is <strong>test page</strong></p>\n","excerpt":"","more":"<h2 id=\"Hello\"><a href=\"#Hello\" class=\"headerlink\" title=\"Hello\"></a>Hello</h2><p><code>tags</code> this is <strong>test page</strong></p>\n"},{"layout":"tags","title":"tags","_content":"","source":"tags/index.md","raw":"---\nlayout: tags\ntitle: tags\n---\n","date":"2016-10-11T17:22:25.000Z","updated":"2016-10-11T17:22:25.000Z","path":"tags/index.html","comments":1,"_id":"ciua0m2da000h0inul5b5a0re","content":"","excerpt":"","more":""}],"Post":[{"title":"Spring 与 MyBatis 的集成详解","date":"2016-10-13T17:32:09.000Z","_content":"# 前言\n> MyBatis 是支持定制化 SQL、存储过程以及高级映射的优秀的持久层框架。MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集。MyBatis 可以对配置和原生Map使用简单的 XML 或注解，将接口和 Java 的 POJOs(Plain Old Java Objects,普通的 Java对象)映射成数据库中的记录。\n\n> —— 摘自 [MyBatis 中文官网](http://www.mybatis.org/mybatis-3/zh/)\n\n# Spring 与 MyBatis 的集成\nMyBatis  与 Spring  的集成思路，总共有以下几个步骤：\n\n1. 引入 MyBatis  与 Spring  框架相关的包，数据库驱动的包，可引入数据库连接池、日志、测试相关包\n2. 配置XML，包括数据源 DataSource （用于指定数据库连接地址、账号、密码等数据库配置）和 SqlSessionFactory  （用于指定 MyBatis 自动载入的 *Mapper.xml）\n3. 编写 Entity 类，用来存储数据库查询返回数据，一般而言，成员变量对应数据库表字段名，仅提供 getter/setter  方法\n4. 编写 Mapper 接口 与 \\*Mapper.xml ，Mapper 接口 指定操作名，并规定好传入参数，\\*Mapper.xml  为数据库操作的 SQL ，id  需要与 Mapper 接口 一致\n5. 创建数据库，编写服务，测试\n\n## 从 Maven 引入 jar 包\n在 Maven  项目中的 pom.xml  文件增加以下依赖。项目一般还需要增加 log 日志模块、junit 测试模块等，在此 pom.xml  不再赘述。\n\n```xml\n<dependencies>\n    <!-- Maven Lib -->\n    <!-- Spring -->\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-core</artifactId>\n        <version>${spring.version}</version>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-context</artifactId>\n        <version>${spring.version}</version>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-beans</artifactId>\n        <version>${spring.version}</version>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-web</artifactId>\n        <version>${spring.version}</version>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-tx</artifactId>\n        <version>${spring.version}</version>\n    </dependency>\n    <!-- Spring AOP -->\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-aop</artifactId>\n        <version>${spring.version}</version>\n    </dependency>\n    <dependency>\n        <groupId>org.aspectj</groupId>\n        <artifactId>aspectjweaver</artifactId>\n        <version>1.8.9</version>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-jdbc</artifactId>\n        <version>${spri\n    <!-- Servlet -->\n    <dependency>\n        <groupId>javax.servlet</groupId>\n        <artifactId>servlet-api</artifactId>\n        <version>2.5</version>\n    </dependency>\n\n    <!-- MyBatis -->\n    <dependency>\n        <groupId>org.mybatis</groupId>\n        <artifactId>mybatis</artifactId>\n        <version>3.4.1</version>\n    </dependency>\n    <dependency>\n        <groupId>org.mybatis</groupId>\n        <artifactId>mybatis-spring</artifactId>\n        <version>1.3.0</version>\n    </dependency>\n\n    <!-- 连接池 -->\n    <dependency>\n        <groupId>c3p0</groupId>\n        <artifactId>c3p0</artifactId>\n        <version>0.9.1.2</version>\n    </dependency>\n\n    <!--  mysql driver -->\n    <dependency>\n        <groupId>mysql</groupId>\n        <artifactId>mysql-connector-java</artifactId>\n        <version>5.1.39</version>\n    </dependency>\n</dependencies>\n```\n\n## 创建数据库环境\n因为 MyBatis  框架是解决持久化或者说数据库的问题，因此我们需要配置一下数据库环境。\n\n```sql\nDROP TABLE IF EXISTS `t_user`;\nCREATE TABLE `t_user` (\n\t`id` INT(12) NOT NULL AUTO_INCREMENT,\n\t`name` VARCHAR(255) NOT NULL,\n\t`age` INT(4) DEFAULT 0,\n\t`gender` INT(2),\n\tPRIMARY KEY(`id`)\n) ENGINE=INNODB DEFAULT CHARSET=utf8;\n```\n\n## 配置 sqlSessionFactory 与 DataSource\n要使用 MyBatis ，至少需要一个 SqlSessionFactoryBean  是用于创建 SqlSessionFactory  的。要配置这个 Factory bean ，放置下面的代码在 Spring 的 XML 配置文件中。我在配置时，将数据库相关的配置都创建了一个独立的 XML 配置文件，然后在 Spring 主配置文件中通过 import 引用。\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\">\n\n    <!-- mysql data source -->\n    <bean id=\"dataSource\" class=\"com.mchange.v2.c3p0.ComboPooledDataSource\" destroy-method=\"close\" lazy-init=\"false\">\n        <property name=\"driverClass\" value=\"${jdbc.driverclass}\"/>\n        <property name=\"jdbcUrl\" value=\"${jdbc.url}\"/>\n        <property name=\"user\" value=\"${jdbc.username}\"/>\n        <property name=\"password\" value=\"${jdbc.password}\"/>\n        <property name=\"idleConnectionTestPeriod\" value=\"60\"/>\n        <property name=\"testConnectionOnCheckout\" value=\"false\"/>\n        <property name=\"initialPoolSize\" value=\"2\"/>\n        <property name=\"minPoolSize\" value=\"5\"/>\n        <property name=\"maxPoolSize\" value=\"50\"/>\n        <property name=\"acquireIncrement\" value=\"1\"/>\n        <property name=\"acquireRetryAttempts\" value=\"1\"/>\n        <property name=\"maxIdleTime\" value=\"6000\"/>\n        <property name=\"maxStatements\" value=\"0\"/>\n    </bean>\n\n    <!-- SqlSessionFactory -->\n    <bean id=\"sqlSessionFactory\" class=\"org.mybatis.spring.SqlSessionFactoryBean\">\n        <property name=\"dataSource\" ref=\"dataSource\"/>\n        <!-- Mapper文件存放的位置，当Mapper文件跟对应的Mapper接口处于同一位置的时候可以不用指定该属性的值 -->\n        <property name=\"mapperLocations\" value=\"classpath*:sqlmap/*.xml\"/>\n    </bean>\n\n    <!-- DAO Mapper -->\n    <bean class=\"org.mybatis.spring.mapper.MapperScannerConfigurer\">\n        <property name=\"annotationClass\" value=\"org.springframework.stereotype.Repository\" />\n        <!-- 扫描器开始扫描的基础包名，支持嵌套扫描 -->\n        <property name=\"basePackage\" value=\"com.test.dao.mapper\" />\n    </bean>\n</beans>\n```\n\n以上是 my-db.xml  配置文件，主要分为三部分:\n\n1. datasource ，数据源，与数据库连接相关，配置数据库的地址、账户、密码，一些配置等等，从 jdbc.properties 文件中载入。关于 Spring 如何载入 properties 文件如何实现，不在这篇文章赘述了。\n2. sqlSessionFactory ，数据库会话工厂。从 *Mapper.xml  中文件自动载入 <mapper>\n3. Mapper 类 ，在此配置中采用 Scanner 方式，自动从 mapper 包内载入 mapper 类。\n\n## 调用 MyBatis 框架\n### 创建 Entity，映射 Database 表（或有）\n在 entity 包中创建实体，对应 t_user 表 的返回。成员变量一般与数据库表字段名一一对应，成员方法仅提供 getter/setter  方法。\n\n实体类不是必须的，MyBatis  提供将数据库返回简单的映射到 Map 或 HashMap 结构中，而非 POJO 中。\n\n```java\n/**\n * t_user 表实体\n */\npublic class User  implements Serializable {\n    private int id;\n    private String name;\n    private int age;\n    private int gender;\n\n    public int getId() { return id; }\n    public void setId(int id) { this.id = id; }\n    public String getName() { return name; }\n    public void setName(String name) { this.name = name; }\n    public int getAge() { return age; }\n    public void setAge(int age) { this.age = age; }\n    public int getGender() { return gender; }\n    public void setGender(int gender) { this.gender = gender; }\n}\n```\n\n### 创建 DAO/Mapper\n在 dao.mapper 包内创建 UserMapper 接口 ，并添加 @Repository  注解\n\n```java\n@Repository\npublic interface UserMapper {\n    public List<User> findUserById(int id);\n    public Integer insertUser(User user);\n}\n```\n\n对应具体数据库的方法，例如插入用户、通过 id 查找用户。每次需要定义一个数据库操作，就在 Mapper 类中定义一个**接口**。\n\n> 注意，因为在三、配置 sqlSessionFactory 与 DataSource ，定义了自动载入 Mapper 类 。因此，需要加入了 @Repository  的注解，用于标注数据访问组件，即DAO 组件。否则不需要 @Repository  注解，但需要在 *Mapper.xml  中增加 <mapper>  配置。\n\n### 配置 Mapper.xml\n在 Mapper.xml  中编写具体的数据库操作的 SQL。\n\n其中，tag 有 insert, select, update  等\n\nid 与 Mapper 接口方法名一一对应；\n\nparameterType  为传入参数，可以是 POJO，也可以是 int、String 这种基本类型，SQL 中的参数用 #{id}  的形式表示；\n\nresultType  或者 resultMap ，都是存储返回的结果集，其中 resultMap  比较强大，灵活；resultType  可以简单指定为 map 或者 POJO。\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\" >\n<mapper namespace=\"com.test.dao.mapper.UserMapper\">\n    <!--配置一个resultMap 指定返回的类型 -->\n    <resultMap id=\"userInfo\" type=\"com.test.entity.User\">\n        <id column=\"id\" property=\"id\"/>\n        <result column=\"name\" property=\"name\"/>\n        <result column=\"age\" property=\"age\"/>\n        <result column=\"gender\" property=\"gender\"/>\n    </resultMap>\n\n    <select id=\"queryUserInfos\" resultMap=\"userInfo\" parameterType=\"java.lang.Integer\">\n        SELECT * FROM t_user WHERE age = #{age} ORDER BY id DESC;\n    </select>\n\n    <insert id=\"insertUserInfo\" parameterType=\"com.test.entity.User\">\n        INSERT INTO t_user(name, age, gender) VALUES (#{userName},#{age},#{gender})\n        <selectKey resultType=\"int\" keyProperty=\"id\">\n            SELECT LAST_INSERT_ID();\n        </selectKey>\n    </insert>\n</mapper>\n```\n> 关于 \\*Mapper.xml文件的配置，详情参考[官方文档](http://www.mybatis.org/mybatis-3/zh/sqlmap-xml.html)\n\n### 通过服务调用\n已经完成上述配置和接口等编写后，就可以在服务中调用了。\n\n```java\n@Service(value = \"userService\")\npublic class UserServiceImpl implements UserService{\n    @Autowired\n    private UserMapper userMapper;\n\n    @Override\n    public List<User> getUser(Integer id) {\n        List x =  userMapper.findUserById(id);\n        return x;\n    }\n\n    @Override\n    public Integer addUser(User user) {\n        return userMapper.insertUser(user);\n    }\n}\n```\n在系统设计时，不会让服务直接就去调用如此底层的操作，往往会增加一个 model 层或者 controller 层。调用方法还是一致的，都是先注入 Mapper 接口，然后调用接口方法就可以了。\n\n#参考资料\n1. MyBatis 与 Spring 集成，官网 http://www.mybatis.org/spring/zh/getting-started.html\n2. MyBatis 官网，配置和使用介绍，http://www.mybatis.org/mybatis-3/zh/configuration.html\n3. SSM框架——详细整合教程（Spring+SpringMVC+MyBatis），作者 shu_lin，http://blog.csdn.net/zhshulin/article/details/37956105\n\n\n","source":"_posts/Spring-与-MyBatis-的集成详解.md","raw":"---\ntitle: Spring 与 MyBatis 的集成详解\ndate: 2016-10-14 01:32:09\ntags: Spring\n---\n# 前言\n> MyBatis 是支持定制化 SQL、存储过程以及高级映射的优秀的持久层框架。MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集。MyBatis 可以对配置和原生Map使用简单的 XML 或注解，将接口和 Java 的 POJOs(Plain Old Java Objects,普通的 Java对象)映射成数据库中的记录。\n\n> —— 摘自 [MyBatis 中文官网](http://www.mybatis.org/mybatis-3/zh/)\n\n# Spring 与 MyBatis 的集成\nMyBatis  与 Spring  的集成思路，总共有以下几个步骤：\n\n1. 引入 MyBatis  与 Spring  框架相关的包，数据库驱动的包，可引入数据库连接池、日志、测试相关包\n2. 配置XML，包括数据源 DataSource （用于指定数据库连接地址、账号、密码等数据库配置）和 SqlSessionFactory  （用于指定 MyBatis 自动载入的 *Mapper.xml）\n3. 编写 Entity 类，用来存储数据库查询返回数据，一般而言，成员变量对应数据库表字段名，仅提供 getter/setter  方法\n4. 编写 Mapper 接口 与 \\*Mapper.xml ，Mapper 接口 指定操作名，并规定好传入参数，\\*Mapper.xml  为数据库操作的 SQL ，id  需要与 Mapper 接口 一致\n5. 创建数据库，编写服务，测试\n\n## 从 Maven 引入 jar 包\n在 Maven  项目中的 pom.xml  文件增加以下依赖。项目一般还需要增加 log 日志模块、junit 测试模块等，在此 pom.xml  不再赘述。\n\n```xml\n<dependencies>\n    <!-- Maven Lib -->\n    <!-- Spring -->\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-core</artifactId>\n        <version>${spring.version}</version>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-context</artifactId>\n        <version>${spring.version}</version>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-beans</artifactId>\n        <version>${spring.version}</version>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-web</artifactId>\n        <version>${spring.version}</version>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-tx</artifactId>\n        <version>${spring.version}</version>\n    </dependency>\n    <!-- Spring AOP -->\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-aop</artifactId>\n        <version>${spring.version}</version>\n    </dependency>\n    <dependency>\n        <groupId>org.aspectj</groupId>\n        <artifactId>aspectjweaver</artifactId>\n        <version>1.8.9</version>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-jdbc</artifactId>\n        <version>${spri\n    <!-- Servlet -->\n    <dependency>\n        <groupId>javax.servlet</groupId>\n        <artifactId>servlet-api</artifactId>\n        <version>2.5</version>\n    </dependency>\n\n    <!-- MyBatis -->\n    <dependency>\n        <groupId>org.mybatis</groupId>\n        <artifactId>mybatis</artifactId>\n        <version>3.4.1</version>\n    </dependency>\n    <dependency>\n        <groupId>org.mybatis</groupId>\n        <artifactId>mybatis-spring</artifactId>\n        <version>1.3.0</version>\n    </dependency>\n\n    <!-- 连接池 -->\n    <dependency>\n        <groupId>c3p0</groupId>\n        <artifactId>c3p0</artifactId>\n        <version>0.9.1.2</version>\n    </dependency>\n\n    <!--  mysql driver -->\n    <dependency>\n        <groupId>mysql</groupId>\n        <artifactId>mysql-connector-java</artifactId>\n        <version>5.1.39</version>\n    </dependency>\n</dependencies>\n```\n\n## 创建数据库环境\n因为 MyBatis  框架是解决持久化或者说数据库的问题，因此我们需要配置一下数据库环境。\n\n```sql\nDROP TABLE IF EXISTS `t_user`;\nCREATE TABLE `t_user` (\n\t`id` INT(12) NOT NULL AUTO_INCREMENT,\n\t`name` VARCHAR(255) NOT NULL,\n\t`age` INT(4) DEFAULT 0,\n\t`gender` INT(2),\n\tPRIMARY KEY(`id`)\n) ENGINE=INNODB DEFAULT CHARSET=utf8;\n```\n\n## 配置 sqlSessionFactory 与 DataSource\n要使用 MyBatis ，至少需要一个 SqlSessionFactoryBean  是用于创建 SqlSessionFactory  的。要配置这个 Factory bean ，放置下面的代码在 Spring 的 XML 配置文件中。我在配置时，将数据库相关的配置都创建了一个独立的 XML 配置文件，然后在 Spring 主配置文件中通过 import 引用。\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\">\n\n    <!-- mysql data source -->\n    <bean id=\"dataSource\" class=\"com.mchange.v2.c3p0.ComboPooledDataSource\" destroy-method=\"close\" lazy-init=\"false\">\n        <property name=\"driverClass\" value=\"${jdbc.driverclass}\"/>\n        <property name=\"jdbcUrl\" value=\"${jdbc.url}\"/>\n        <property name=\"user\" value=\"${jdbc.username}\"/>\n        <property name=\"password\" value=\"${jdbc.password}\"/>\n        <property name=\"idleConnectionTestPeriod\" value=\"60\"/>\n        <property name=\"testConnectionOnCheckout\" value=\"false\"/>\n        <property name=\"initialPoolSize\" value=\"2\"/>\n        <property name=\"minPoolSize\" value=\"5\"/>\n        <property name=\"maxPoolSize\" value=\"50\"/>\n        <property name=\"acquireIncrement\" value=\"1\"/>\n        <property name=\"acquireRetryAttempts\" value=\"1\"/>\n        <property name=\"maxIdleTime\" value=\"6000\"/>\n        <property name=\"maxStatements\" value=\"0\"/>\n    </bean>\n\n    <!-- SqlSessionFactory -->\n    <bean id=\"sqlSessionFactory\" class=\"org.mybatis.spring.SqlSessionFactoryBean\">\n        <property name=\"dataSource\" ref=\"dataSource\"/>\n        <!-- Mapper文件存放的位置，当Mapper文件跟对应的Mapper接口处于同一位置的时候可以不用指定该属性的值 -->\n        <property name=\"mapperLocations\" value=\"classpath*:sqlmap/*.xml\"/>\n    </bean>\n\n    <!-- DAO Mapper -->\n    <bean class=\"org.mybatis.spring.mapper.MapperScannerConfigurer\">\n        <property name=\"annotationClass\" value=\"org.springframework.stereotype.Repository\" />\n        <!-- 扫描器开始扫描的基础包名，支持嵌套扫描 -->\n        <property name=\"basePackage\" value=\"com.test.dao.mapper\" />\n    </bean>\n</beans>\n```\n\n以上是 my-db.xml  配置文件，主要分为三部分:\n\n1. datasource ，数据源，与数据库连接相关，配置数据库的地址、账户、密码，一些配置等等，从 jdbc.properties 文件中载入。关于 Spring 如何载入 properties 文件如何实现，不在这篇文章赘述了。\n2. sqlSessionFactory ，数据库会话工厂。从 *Mapper.xml  中文件自动载入 <mapper>\n3. Mapper 类 ，在此配置中采用 Scanner 方式，自动从 mapper 包内载入 mapper 类。\n\n## 调用 MyBatis 框架\n### 创建 Entity，映射 Database 表（或有）\n在 entity 包中创建实体，对应 t_user 表 的返回。成员变量一般与数据库表字段名一一对应，成员方法仅提供 getter/setter  方法。\n\n实体类不是必须的，MyBatis  提供将数据库返回简单的映射到 Map 或 HashMap 结构中，而非 POJO 中。\n\n```java\n/**\n * t_user 表实体\n */\npublic class User  implements Serializable {\n    private int id;\n    private String name;\n    private int age;\n    private int gender;\n\n    public int getId() { return id; }\n    public void setId(int id) { this.id = id; }\n    public String getName() { return name; }\n    public void setName(String name) { this.name = name; }\n    public int getAge() { return age; }\n    public void setAge(int age) { this.age = age; }\n    public int getGender() { return gender; }\n    public void setGender(int gender) { this.gender = gender; }\n}\n```\n\n### 创建 DAO/Mapper\n在 dao.mapper 包内创建 UserMapper 接口 ，并添加 @Repository  注解\n\n```java\n@Repository\npublic interface UserMapper {\n    public List<User> findUserById(int id);\n    public Integer insertUser(User user);\n}\n```\n\n对应具体数据库的方法，例如插入用户、通过 id 查找用户。每次需要定义一个数据库操作，就在 Mapper 类中定义一个**接口**。\n\n> 注意，因为在三、配置 sqlSessionFactory 与 DataSource ，定义了自动载入 Mapper 类 。因此，需要加入了 @Repository  的注解，用于标注数据访问组件，即DAO 组件。否则不需要 @Repository  注解，但需要在 *Mapper.xml  中增加 <mapper>  配置。\n\n### 配置 Mapper.xml\n在 Mapper.xml  中编写具体的数据库操作的 SQL。\n\n其中，tag 有 insert, select, update  等\n\nid 与 Mapper 接口方法名一一对应；\n\nparameterType  为传入参数，可以是 POJO，也可以是 int、String 这种基本类型，SQL 中的参数用 #{id}  的形式表示；\n\nresultType  或者 resultMap ，都是存储返回的结果集，其中 resultMap  比较强大，灵活；resultType  可以简单指定为 map 或者 POJO。\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\" >\n<mapper namespace=\"com.test.dao.mapper.UserMapper\">\n    <!--配置一个resultMap 指定返回的类型 -->\n    <resultMap id=\"userInfo\" type=\"com.test.entity.User\">\n        <id column=\"id\" property=\"id\"/>\n        <result column=\"name\" property=\"name\"/>\n        <result column=\"age\" property=\"age\"/>\n        <result column=\"gender\" property=\"gender\"/>\n    </resultMap>\n\n    <select id=\"queryUserInfos\" resultMap=\"userInfo\" parameterType=\"java.lang.Integer\">\n        SELECT * FROM t_user WHERE age = #{age} ORDER BY id DESC;\n    </select>\n\n    <insert id=\"insertUserInfo\" parameterType=\"com.test.entity.User\">\n        INSERT INTO t_user(name, age, gender) VALUES (#{userName},#{age},#{gender})\n        <selectKey resultType=\"int\" keyProperty=\"id\">\n            SELECT LAST_INSERT_ID();\n        </selectKey>\n    </insert>\n</mapper>\n```\n> 关于 \\*Mapper.xml文件的配置，详情参考[官方文档](http://www.mybatis.org/mybatis-3/zh/sqlmap-xml.html)\n\n### 通过服务调用\n已经完成上述配置和接口等编写后，就可以在服务中调用了。\n\n```java\n@Service(value = \"userService\")\npublic class UserServiceImpl implements UserService{\n    @Autowired\n    private UserMapper userMapper;\n\n    @Override\n    public List<User> getUser(Integer id) {\n        List x =  userMapper.findUserById(id);\n        return x;\n    }\n\n    @Override\n    public Integer addUser(User user) {\n        return userMapper.insertUser(user);\n    }\n}\n```\n在系统设计时，不会让服务直接就去调用如此底层的操作，往往会增加一个 model 层或者 controller 层。调用方法还是一致的，都是先注入 Mapper 接口，然后调用接口方法就可以了。\n\n#参考资料\n1. MyBatis 与 Spring 集成，官网 http://www.mybatis.org/spring/zh/getting-started.html\n2. MyBatis 官网，配置和使用介绍，http://www.mybatis.org/mybatis-3/zh/configuration.html\n3. SSM框架——详细整合教程（Spring+SpringMVC+MyBatis），作者 shu_lin，http://blog.csdn.net/zhshulin/article/details/37956105\n\n\n","slug":"Spring-与-MyBatis-的集成详解","published":1,"updated":"2016-10-14T15:30:23.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciua0m27k00010inu72jc5afu","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><blockquote>\n<p>MyBatis 是支持定制化 SQL、存储过程以及高级映射的优秀的持久层框架。MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集。MyBatis 可以对配置和原生Map使用简单的 XML 或注解，将接口和 Java 的 POJOs(Plain Old Java Objects,普通的 Java对象)映射成数据库中的记录。</p>\n<p>—— 摘自 <a href=\"http://www.mybatis.org/mybatis-3/zh/\" target=\"_blank\" rel=\"external\">MyBatis 中文官网</a></p>\n</blockquote>\n<h1 id=\"Spring-与-MyBatis-的集成\"><a href=\"#Spring-与-MyBatis-的集成\" class=\"headerlink\" title=\"Spring 与 MyBatis 的集成\"></a>Spring 与 MyBatis 的集成</h1><p>MyBatis  与 Spring  的集成思路，总共有以下几个步骤：</p>\n<ol>\n<li>引入 MyBatis  与 Spring  框架相关的包，数据库驱动的包，可引入数据库连接池、日志、测试相关包</li>\n<li>配置XML，包括数据源 DataSource （用于指定数据库连接地址、账号、密码等数据库配置）和 SqlSessionFactory  （用于指定 MyBatis 自动载入的 *Mapper.xml）</li>\n<li>编写 Entity 类，用来存储数据库查询返回数据，一般而言，成员变量对应数据库表字段名，仅提供 getter/setter  方法</li>\n<li>编写 Mapper 接口 与 *Mapper.xml ，Mapper 接口 指定操作名，并规定好传入参数，*Mapper.xml  为数据库操作的 SQL ，id  需要与 Mapper 接口 一致</li>\n<li>创建数据库，编写服务，测试</li>\n</ol>\n<h2 id=\"从-Maven-引入-jar-包\"><a href=\"#从-Maven-引入-jar-包\" class=\"headerlink\" title=\"从 Maven 引入 jar 包\"></a>从 Maven 引入 jar 包</h2><p>在 Maven  项目中的 pom.xml  文件增加以下依赖。项目一般还需要增加 log 日志模块、junit 测试模块等，在此 pom.xml  不再赘述。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Maven Lib --&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Spring --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-core<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-context<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-beans<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-tx<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Spring AOP --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-aop<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.aspectj<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>aspectjweaver<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.8.9<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-jdbc<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spri</div><div class=\"line\">    <span class=\"comment\">&lt;!-- Servlet --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>javax.servlet<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>servlet-api<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.5<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!-- MyBatis --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.4.1<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-spring<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.3.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!-- 连接池 --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>c3p0<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>c3p0<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.9.1.2<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!--  mysql driver --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>5.1.39<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></div></pre></td></tr></table></figure>\n<h2 id=\"创建数据库环境\"><a href=\"#创建数据库环境\" class=\"headerlink\" title=\"创建数据库环境\"></a>创建数据库环境</h2><p>因为 MyBatis  框架是解决持久化或者说数据库的问题，因此我们需要配置一下数据库环境。</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">IF</span> <span class=\"keyword\">EXISTS</span> <span class=\"string\">`t_user`</span>;</div><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> <span class=\"string\">`t_user`</span> (</div><div class=\"line\">\t<span class=\"string\">`id`</span> <span class=\"built_in\">INT</span>(<span class=\"number\">12</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> AUTO_INCREMENT,</div><div class=\"line\">\t<span class=\"string\">`name`</span> <span class=\"built_in\">VARCHAR</span>(<span class=\"number\">255</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span>,</div><div class=\"line\">\t<span class=\"string\">`age`</span> <span class=\"built_in\">INT</span>(<span class=\"number\">4</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"number\">0</span>,</div><div class=\"line\">\t<span class=\"string\">`gender`</span> <span class=\"built_in\">INT</span>(<span class=\"number\">2</span>),</div><div class=\"line\">\tPRIMARY <span class=\"keyword\">KEY</span>(<span class=\"string\">`id`</span>)</div><div class=\"line\">) <span class=\"keyword\">ENGINE</span>=<span class=\"keyword\">INNODB</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">CHARSET</span>=utf8;</div></pre></td></tr></table></figure>\n<h2 id=\"配置-sqlSessionFactory-与-DataSource\"><a href=\"#配置-sqlSessionFactory-与-DataSource\" class=\"headerlink\" title=\"配置 sqlSessionFactory 与 DataSource\"></a>配置 sqlSessionFactory 与 DataSource</h2><p>要使用 MyBatis ，至少需要一个 SqlSessionFactoryBean  是用于创建 SqlSessionFactory  的。要配置这个 Factory bean ，放置下面的代码在 Spring 的 XML 配置文件中。我在配置时，将数据库相关的配置都创建了一个独立的 XML 配置文件，然后在 Spring 主配置文件中通过 import 引用。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">beans</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans\"</span></span></div><div class=\"line\">       <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span></div><div class=\"line\">       <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\"</span>&gt;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!-- mysql data source --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"dataSource\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.mchange.v2.c3p0.ComboPooledDataSource\"</span> <span class=\"attr\">destroy-method</span>=<span class=\"string\">\"close\"</span> <span class=\"attr\">lazy-init</span>=<span class=\"string\">\"false\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"driverClass\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;jdbc.driverclass&#125;\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"jdbcUrl\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;jdbc.url&#125;\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"user\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;jdbc.username&#125;\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"password\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;jdbc.password&#125;\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"idleConnectionTestPeriod\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"60\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"testConnectionOnCheckout\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"false\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"initialPoolSize\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"2\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"minPoolSize\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"5\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"maxPoolSize\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"50\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"acquireIncrement\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"1\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"acquireRetryAttempts\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"1\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"maxIdleTime\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"6000\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"maxStatements\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"0\"</span>/&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!-- SqlSessionFactory --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"sqlSessionFactory\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.mybatis.spring.SqlSessionFactoryBean\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"dataSource\"</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"dataSource\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"comment\">&lt;!-- Mapper文件存放的位置，当Mapper文件跟对应的Mapper接口处于同一位置的时候可以不用指定该属性的值 --&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"mapperLocations\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"classpath*:sqlmap/*.xml\"</span>/&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!-- DAO Mapper --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.mybatis.spring.mapper.MapperScannerConfigurer\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"annotationClass\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"org.springframework.stereotype.Repository\"</span> /&gt;</span></div><div class=\"line\">        <span class=\"comment\">&lt;!-- 扫描器开始扫描的基础包名，支持嵌套扫描 --&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"basePackage\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"com.test.dao.mapper\"</span> /&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>以上是 my-db.xml  配置文件，主要分为三部分:</p>\n<ol>\n<li>datasource ，数据源，与数据库连接相关，配置数据库的地址、账户、密码，一些配置等等，从 jdbc.properties 文件中载入。关于 Spring 如何载入 properties 文件如何实现，不在这篇文章赘述了。</li>\n<li>sqlSessionFactory ，数据库会话工厂。从 *Mapper.xml  中文件自动载入 <mapper></mapper></li>\n<li>Mapper 类 ，在此配置中采用 Scanner 方式，自动从 mapper 包内载入 mapper 类。</li>\n</ol>\n<h2 id=\"调用-MyBatis-框架\"><a href=\"#调用-MyBatis-框架\" class=\"headerlink\" title=\"调用 MyBatis 框架\"></a>调用 MyBatis 框架</h2><h3 id=\"创建-Entity，映射-Database-表（或有）\"><a href=\"#创建-Entity，映射-Database-表（或有）\" class=\"headerlink\" title=\"创建 Entity，映射 Database 表（或有）\"></a>创建 Entity，映射 Database 表（或有）</h3><p>在 entity 包中创建实体，对应 t_user 表 的返回。成员变量一般与数据库表字段名一一对应，成员方法仅提供 getter/setter  方法。</p>\n<p>实体类不是必须的，MyBatis  提供将数据库返回简单的映射到 Map 或 HashMap 结构中，而非 POJO 中。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * t_user 表实体</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span>  <span class=\"keyword\">implements</span> <span class=\"title\">Serializable</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> id;</div><div class=\"line\">    <span class=\"keyword\">private</span> String name;</div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> age;</div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> gender;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getId</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> id; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setId</span><span class=\"params\">(<span class=\"keyword\">int</span> id)</span> </span>&#123; <span class=\"keyword\">this</span>.id = id; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> name; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setName</span><span class=\"params\">(String name)</span> </span>&#123; <span class=\"keyword\">this</span>.name = name; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getAge</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> age; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setAge</span><span class=\"params\">(<span class=\"keyword\">int</span> age)</span> </span>&#123; <span class=\"keyword\">this</span>.age = age; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getGender</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> gender; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setGender</span><span class=\"params\">(<span class=\"keyword\">int</span> gender)</span> </span>&#123; <span class=\"keyword\">this</span>.gender = gender; &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"创建-DAO-Mapper\"><a href=\"#创建-DAO-Mapper\" class=\"headerlink\" title=\"创建 DAO/Mapper\"></a>创建 DAO/Mapper</h3><p>在 dao.mapper 包内创建 UserMapper 接口 ，并添加 @Repository  注解</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Repository</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">UserMapper</span> </span>&#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> List&lt;User&gt; <span class=\"title\">findUserById</span><span class=\"params\">(<span class=\"keyword\">int</span> id)</span></span>;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Integer <span class=\"title\">insertUser</span><span class=\"params\">(User user)</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>对应具体数据库的方法，例如插入用户、通过 id 查找用户。每次需要定义一个数据库操作，就在 Mapper 类中定义一个<strong>接口</strong>。</p>\n<blockquote>\n<p>注意，因为在三、配置 sqlSessionFactory 与 DataSource ，定义了自动载入 Mapper 类 。因此，需要加入了 @Repository  的注解，用于标注数据访问组件，即DAO 组件。否则不需要 @Repository  注解，但需要在 *Mapper.xml  中增加 <mapper>  配置。</mapper></p>\n</blockquote>\n<h3 id=\"配置-Mapper-xml\"><a href=\"#配置-Mapper-xml\" class=\"headerlink\" title=\"配置 Mapper.xml\"></a>配置 Mapper.xml</h3><p>在 Mapper.xml  中编写具体的数据库操作的 SQL。</p>\n<p>其中，tag 有 insert, select, update  等</p>\n<p>id 与 Mapper 接口方法名一一对应；</p>\n<p>parameterType  为传入参数，可以是 POJO，也可以是 int、String 这种基本类型，SQL 中的参数用 #{id}  的形式表示；</p>\n<p>resultType  或者 resultMap ，都是存储返回的结果集，其中 resultMap  比较强大，灵活；resultType  可以简单指定为 map 或者 POJO。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;</div><div class=\"line\"><span class=\"meta\">&lt;!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\" &gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mapper</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"com.test.dao.mapper.UserMapper\"</span>&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!--配置一个resultMap 指定返回的类型 --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">\"userInfo\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"com.test.entity.User\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">id</span> <span class=\"attr\">column</span>=<span class=\"string\">\"id\"</span> <span class=\"attr\">property</span>=<span class=\"string\">\"id\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">\"name\"</span> <span class=\"attr\">property</span>=<span class=\"string\">\"name\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">\"age\"</span> <span class=\"attr\">property</span>=<span class=\"string\">\"age\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">\"gender\"</span> <span class=\"attr\">property</span>=<span class=\"string\">\"gender\"</span>/&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">\"queryUserInfos\"</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">\"userInfo\"</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">\"java.lang.Integer\"</span>&gt;</span></div><div class=\"line\">        SELECT * FROM t_user WHERE age = #&#123;age&#125; ORDER BY id DESC;</div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">insert</span> <span class=\"attr\">id</span>=<span class=\"string\">\"insertUserInfo\"</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">\"com.test.entity.User\"</span>&gt;</span></div><div class=\"line\">        INSERT INTO t_user(name, age, gender) VALUES (#&#123;userName&#125;,#&#123;age&#125;,#&#123;gender&#125;)</div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">selectKey</span> <span class=\"attr\">resultType</span>=<span class=\"string\">\"int\"</span> <span class=\"attr\">keyProperty</span>=<span class=\"string\">\"id\"</span>&gt;</span></div><div class=\"line\">            SELECT LAST_INSERT_ID();</div><div class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">selectKey</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">insert</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mapper</span>&gt;</span></div></pre></td></tr></table></figure>\n<blockquote>\n<p>关于 *Mapper.xml文件的配置，详情参考<a href=\"http://www.mybatis.org/mybatis-3/zh/sqlmap-xml.html\" target=\"_blank\" rel=\"external\">官方文档</a></p>\n</blockquote>\n<h3 id=\"通过服务调用\"><a href=\"#通过服务调用\" class=\"headerlink\" title=\"通过服务调用\"></a>通过服务调用</h3><p>已经完成上述配置和接口等编写后，就可以在服务中调用了。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Service</span>(value = <span class=\"string\">\"userService\"</span>)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UserServiceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title\">UserService</span></span>&#123;</div><div class=\"line\">    <span class=\"meta\">@Autowired</span></div><div class=\"line\">    <span class=\"keyword\">private</span> UserMapper userMapper;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> List&lt;User&gt; <span class=\"title\">getUser</span><span class=\"params\">(Integer id)</span> </span>&#123;</div><div class=\"line\">        List x =  userMapper.findUserById(id);</div><div class=\"line\">        <span class=\"keyword\">return</span> x;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Integer <span class=\"title\">addUser</span><span class=\"params\">(User user)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> userMapper.insertUser(user);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>在系统设计时，不会让服务直接就去调用如此底层的操作，往往会增加一个 model 层或者 controller 层。调用方法还是一致的，都是先注入 Mapper 接口，然后调用接口方法就可以了。</p>\n<p>#参考资料</p>\n<ol>\n<li>MyBatis 与 Spring 集成，官网 <a href=\"http://www.mybatis.org/spring/zh/getting-started.html\" target=\"_blank\" rel=\"external\">http://www.mybatis.org/spring/zh/getting-started.html</a></li>\n<li>MyBatis 官网，配置和使用介绍，<a href=\"http://www.mybatis.org/mybatis-3/zh/configuration.html\" target=\"_blank\" rel=\"external\">http://www.mybatis.org/mybatis-3/zh/configuration.html</a></li>\n<li>SSM框架——详细整合教程（Spring+SpringMVC+MyBatis），作者 shu_lin，<a href=\"http://blog.csdn.net/zhshulin/article/details/37956105\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/zhshulin/article/details/37956105</a></li>\n</ol>\n","excerpt":"","more":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><blockquote>\n<p>MyBatis 是支持定制化 SQL、存储过程以及高级映射的优秀的持久层框架。MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集。MyBatis 可以对配置和原生Map使用简单的 XML 或注解，将接口和 Java 的 POJOs(Plain Old Java Objects,普通的 Java对象)映射成数据库中的记录。</p>\n<p>—— 摘自 <a href=\"http://www.mybatis.org/mybatis-3/zh/\">MyBatis 中文官网</a></p>\n</blockquote>\n<h1 id=\"Spring-与-MyBatis-的集成\"><a href=\"#Spring-与-MyBatis-的集成\" class=\"headerlink\" title=\"Spring 与 MyBatis 的集成\"></a>Spring 与 MyBatis 的集成</h1><p>MyBatis  与 Spring  的集成思路，总共有以下几个步骤：</p>\n<ol>\n<li>引入 MyBatis  与 Spring  框架相关的包，数据库驱动的包，可引入数据库连接池、日志、测试相关包</li>\n<li>配置XML，包括数据源 DataSource （用于指定数据库连接地址、账号、密码等数据库配置）和 SqlSessionFactory  （用于指定 MyBatis 自动载入的 *Mapper.xml）</li>\n<li>编写 Entity 类，用来存储数据库查询返回数据，一般而言，成员变量对应数据库表字段名，仅提供 getter/setter  方法</li>\n<li>编写 Mapper 接口 与 *Mapper.xml ，Mapper 接口 指定操作名，并规定好传入参数，*Mapper.xml  为数据库操作的 SQL ，id  需要与 Mapper 接口 一致</li>\n<li>创建数据库，编写服务，测试</li>\n</ol>\n<h2 id=\"从-Maven-引入-jar-包\"><a href=\"#从-Maven-引入-jar-包\" class=\"headerlink\" title=\"从 Maven 引入 jar 包\"></a>从 Maven 引入 jar 包</h2><p>在 Maven  项目中的 pom.xml  文件增加以下依赖。项目一般还需要增加 log 日志模块、junit 测试模块等，在此 pom.xml  不再赘述。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Maven Lib --&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Spring --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-core<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-context<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-beans<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-tx<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!-- Spring AOP --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-aop<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.aspectj<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>aspectjweaver<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.8.9<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-jdbc<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spri</div><div class=\"line\">    <span class=\"comment\">&lt;!-- Servlet --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>javax.servlet<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>servlet-api<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.5<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!-- MyBatis --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.4.1<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-spring<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.3.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!-- 连接池 --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>c3p0<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>c3p0<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.9.1.2<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!--  mysql driver --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>5.1.39<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></div></pre></td></tr></table></figure>\n<h2 id=\"创建数据库环境\"><a href=\"#创建数据库环境\" class=\"headerlink\" title=\"创建数据库环境\"></a>创建数据库环境</h2><p>因为 MyBatis  框架是解决持久化或者说数据库的问题，因此我们需要配置一下数据库环境。</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">IF</span> <span class=\"keyword\">EXISTS</span> <span class=\"string\">`t_user`</span>;</div><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> <span class=\"string\">`t_user`</span> (</div><div class=\"line\">\t<span class=\"string\">`id`</span> <span class=\"built_in\">INT</span>(<span class=\"number\">12</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> AUTO_INCREMENT,</div><div class=\"line\">\t<span class=\"string\">`name`</span> <span class=\"built_in\">VARCHAR</span>(<span class=\"number\">255</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span>,</div><div class=\"line\">\t<span class=\"string\">`age`</span> <span class=\"built_in\">INT</span>(<span class=\"number\">4</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"number\">0</span>,</div><div class=\"line\">\t<span class=\"string\">`gender`</span> <span class=\"built_in\">INT</span>(<span class=\"number\">2</span>),</div><div class=\"line\">\tPRIMARY <span class=\"keyword\">KEY</span>(<span class=\"string\">`id`</span>)</div><div class=\"line\">) <span class=\"keyword\">ENGINE</span>=<span class=\"keyword\">INNODB</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">CHARSET</span>=utf8;</div></pre></td></tr></table></figure>\n<h2 id=\"配置-sqlSessionFactory-与-DataSource\"><a href=\"#配置-sqlSessionFactory-与-DataSource\" class=\"headerlink\" title=\"配置 sqlSessionFactory 与 DataSource\"></a>配置 sqlSessionFactory 与 DataSource</h2><p>要使用 MyBatis ，至少需要一个 SqlSessionFactoryBean  是用于创建 SqlSessionFactory  的。要配置这个 Factory bean ，放置下面的代码在 Spring 的 XML 配置文件中。我在配置时，将数据库相关的配置都创建了一个独立的 XML 配置文件，然后在 Spring 主配置文件中通过 import 引用。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">beans</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans\"</span></div><div class=\"line\">       <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span></div><div class=\"line\">       <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\"</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!-- mysql data source --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"dataSource\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.mchange.v2.c3p0.ComboPooledDataSource\"</span> <span class=\"attr\">destroy-method</span>=<span class=\"string\">\"close\"</span> <span class=\"attr\">lazy-init</span>=<span class=\"string\">\"false\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"driverClass\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;jdbc.driverclass&#125;\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"jdbcUrl\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;jdbc.url&#125;\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"user\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;jdbc.username&#125;\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"password\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;jdbc.password&#125;\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"idleConnectionTestPeriod\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"60\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"testConnectionOnCheckout\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"false\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"initialPoolSize\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"2\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"minPoolSize\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"5\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"maxPoolSize\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"50\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"acquireIncrement\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"1\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"acquireRetryAttempts\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"1\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"maxIdleTime\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"6000\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"maxStatements\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"0\"</span>/&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!-- SqlSessionFactory --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"sqlSessionFactory\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.mybatis.spring.SqlSessionFactoryBean\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"dataSource\"</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"dataSource\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"comment\">&lt;!-- Mapper文件存放的位置，当Mapper文件跟对应的Mapper接口处于同一位置的时候可以不用指定该属性的值 --&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"mapperLocations\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"classpath*:sqlmap/*.xml\"</span>/&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">&lt;!-- DAO Mapper --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.mybatis.spring.mapper.MapperScannerConfigurer\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"annotationClass\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"org.springframework.stereotype.Repository\"</span> /&gt;</span></div><div class=\"line\">        <span class=\"comment\">&lt;!-- 扫描器开始扫描的基础包名，支持嵌套扫描 --&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"basePackage\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"com.test.dao.mapper\"</span> /&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>以上是 my-db.xml  配置文件，主要分为三部分:</p>\n<ol>\n<li>datasource ，数据源，与数据库连接相关，配置数据库的地址、账户、密码，一些配置等等，从 jdbc.properties 文件中载入。关于 Spring 如何载入 properties 文件如何实现，不在这篇文章赘述了。</li>\n<li>sqlSessionFactory ，数据库会话工厂。从 *Mapper.xml  中文件自动载入 <mapper></li>\n<li>Mapper 类 ，在此配置中采用 Scanner 方式，自动从 mapper 包内载入 mapper 类。</li>\n</ol>\n<h2 id=\"调用-MyBatis-框架\"><a href=\"#调用-MyBatis-框架\" class=\"headerlink\" title=\"调用 MyBatis 框架\"></a>调用 MyBatis 框架</h2><h3 id=\"创建-Entity，映射-Database-表（或有）\"><a href=\"#创建-Entity，映射-Database-表（或有）\" class=\"headerlink\" title=\"创建 Entity，映射 Database 表（或有）\"></a>创建 Entity，映射 Database 表（或有）</h3><p>在 entity 包中创建实体，对应 t_user 表 的返回。成员变量一般与数据库表字段名一一对应，成员方法仅提供 getter/setter  方法。</p>\n<p>实体类不是必须的，MyBatis  提供将数据库返回简单的映射到 Map 或 HashMap 结构中，而非 POJO 中。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * t_user 表实体</div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span>  <span class=\"keyword\">implements</span> <span class=\"title\">Serializable</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> id;</div><div class=\"line\">    <span class=\"keyword\">private</span> String name;</div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> age;</div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> gender;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getId</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> id; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setId</span><span class=\"params\">(<span class=\"keyword\">int</span> id)</span> </span>&#123; <span class=\"keyword\">this</span>.id = id; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> name; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setName</span><span class=\"params\">(String name)</span> </span>&#123; <span class=\"keyword\">this</span>.name = name; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getAge</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> age; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setAge</span><span class=\"params\">(<span class=\"keyword\">int</span> age)</span> </span>&#123; <span class=\"keyword\">this</span>.age = age; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getGender</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> gender; &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setGender</span><span class=\"params\">(<span class=\"keyword\">int</span> gender)</span> </span>&#123; <span class=\"keyword\">this</span>.gender = gender; &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"创建-DAO-Mapper\"><a href=\"#创建-DAO-Mapper\" class=\"headerlink\" title=\"创建 DAO/Mapper\"></a>创建 DAO/Mapper</h3><p>在 dao.mapper 包内创建 UserMapper 接口 ，并添加 @Repository  注解</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Repository</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">UserMapper</span> </span>&#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> List&lt;User&gt; <span class=\"title\">findUserById</span><span class=\"params\">(<span class=\"keyword\">int</span> id)</span></span>;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Integer <span class=\"title\">insertUser</span><span class=\"params\">(User user)</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>对应具体数据库的方法，例如插入用户、通过 id 查找用户。每次需要定义一个数据库操作，就在 Mapper 类中定义一个<strong>接口</strong>。</p>\n<blockquote>\n<p>注意，因为在三、配置 sqlSessionFactory 与 DataSource ，定义了自动载入 Mapper 类 。因此，需要加入了 @Repository  的注解，用于标注数据访问组件，即DAO 组件。否则不需要 @Repository  注解，但需要在 *Mapper.xml  中增加 <mapper>  配置。</p>\n</blockquote>\n<h3 id=\"配置-Mapper-xml\"><a href=\"#配置-Mapper-xml\" class=\"headerlink\" title=\"配置 Mapper.xml\"></a>配置 Mapper.xml</h3><p>在 Mapper.xml  中编写具体的数据库操作的 SQL。</p>\n<p>其中，tag 有 insert, select, update  等</p>\n<p>id 与 Mapper 接口方法名一一对应；</p>\n<p>parameterType  为传入参数，可以是 POJO，也可以是 int、String 这种基本类型，SQL 中的参数用 #{id}  的形式表示；</p>\n<p>resultType  或者 resultMap ，都是存储返回的结果集，其中 resultMap  比较强大，灵活；resultType  可以简单指定为 map 或者 POJO。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;</div><div class=\"line\"><span class=\"meta\">&lt;!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\" &gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mapper</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"com.test.dao.mapper.UserMapper\"</span>&gt;</span></div><div class=\"line\">    <span class=\"comment\">&lt;!--配置一个resultMap 指定返回的类型 --&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">resultMap</span> <span class=\"attr\">id</span>=<span class=\"string\">\"userInfo\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"com.test.entity.User\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">id</span> <span class=\"attr\">column</span>=<span class=\"string\">\"id\"</span> <span class=\"attr\">property</span>=<span class=\"string\">\"id\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">\"name\"</span> <span class=\"attr\">property</span>=<span class=\"string\">\"name\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">\"age\"</span> <span class=\"attr\">property</span>=<span class=\"string\">\"age\"</span>/&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">result</span> <span class=\"attr\">column</span>=<span class=\"string\">\"gender\"</span> <span class=\"attr\">property</span>=<span class=\"string\">\"gender\"</span>/&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">resultMap</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">\"queryUserInfos\"</span> <span class=\"attr\">resultMap</span>=<span class=\"string\">\"userInfo\"</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">\"java.lang.Integer\"</span>&gt;</span></div><div class=\"line\">        SELECT * FROM t_user WHERE age = #&#123;age&#125; ORDER BY id DESC;</div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">insert</span> <span class=\"attr\">id</span>=<span class=\"string\">\"insertUserInfo\"</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">\"com.test.entity.User\"</span>&gt;</span></div><div class=\"line\">        INSERT INTO t_user(name, age, gender) VALUES (#&#123;userName&#125;,#&#123;age&#125;,#&#123;gender&#125;)</div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">selectKey</span> <span class=\"attr\">resultType</span>=<span class=\"string\">\"int\"</span> <span class=\"attr\">keyProperty</span>=<span class=\"string\">\"id\"</span>&gt;</span></div><div class=\"line\">            SELECT LAST_INSERT_ID();</div><div class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">selectKey</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">insert</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mapper</span>&gt;</span></div></pre></td></tr></table></figure>\n<blockquote>\n<p>关于 *Mapper.xml文件的配置，详情参考<a href=\"http://www.mybatis.org/mybatis-3/zh/sqlmap-xml.html\">官方文档</a></p>\n</blockquote>\n<h3 id=\"通过服务调用\"><a href=\"#通过服务调用\" class=\"headerlink\" title=\"通过服务调用\"></a>通过服务调用</h3><p>已经完成上述配置和接口等编写后，就可以在服务中调用了。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Service</span>(value = <span class=\"string\">\"userService\"</span>)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UserServiceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title\">UserService</span></span>&#123;</div><div class=\"line\">    <span class=\"meta\">@Autowired</span></div><div class=\"line\">    <span class=\"keyword\">private</span> UserMapper userMapper;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> List&lt;User&gt; <span class=\"title\">getUser</span><span class=\"params\">(Integer id)</span> </span>&#123;</div><div class=\"line\">        List x =  userMapper.findUserById(id);</div><div class=\"line\">        <span class=\"keyword\">return</span> x;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Integer <span class=\"title\">addUser</span><span class=\"params\">(User user)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> userMapper.insertUser(user);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>在系统设计时，不会让服务直接就去调用如此底层的操作，往往会增加一个 model 层或者 controller 层。调用方法还是一致的，都是先注入 Mapper 接口，然后调用接口方法就可以了。</p>\n<p>#参考资料</p>\n<ol>\n<li>MyBatis 与 Spring 集成，官网 <a href=\"http://www.mybatis.org/spring/zh/getting-started.html\">http://www.mybatis.org/spring/zh/getting-started.html</a></li>\n<li>MyBatis 官网，配置和使用介绍，<a href=\"http://www.mybatis.org/mybatis-3/zh/configuration.html\">http://www.mybatis.org/mybatis-3/zh/configuration.html</a></li>\n<li>SSM框架——详细整合教程（Spring+SpringMVC+MyBatis），作者 shu_lin，<a href=\"http://blog.csdn.net/zhshulin/article/details/37956105\">http://blog.csdn.net/zhshulin/article/details/37956105</a></li>\n</ol>\n"},{"title":"Hello World","_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n","slug":"hello-world","published":1,"date":"2016-10-11T17:22:25.000Z","updated":"2016-10-11T17:22:25.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciua0m27x00030inuds7oglmx","content":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"external\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"external\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"external\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"external\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"external\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo server</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"external\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo generate</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"external\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo deploy</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"external\">Deployment</a></p>\n","excerpt":"","more":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo server</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo generate</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo deploy</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\">Deployment</a></p>\n"},{"title":"漫谈 JDBC 以及与 Spring 之整合","date":"2016-10-14T14:54:38.000Z","_content":"\n# 介绍 JDBC\nJDBC  是 Java 数据库连接（Java Database Connectivity）的简称，是Java语言中用来规范客户端程序如何来访问数据库的应用程序接口，用来连接 Java 与数据库，提供了诸如查询和更新数据库中数据的方法。\n\n## JDBC 架构\nJDBC  的 API  支持两层和三层处理模式进行数据库访问，但一般的 JDBC  架构由两层处理模式组成：\n\n* JDBC API : 提供了应用程序对 JDBC  管理器的连接。\n* JDBC Driver API : 提供了 JDBC  管理器对驱动程序连接。\n\nJDBC API  使用驱动程序管理器和数据库特定的驱动程序来提供异构（heterogeneous）数据库的透明连接。\n\nJDBC  驱动程序管理器可确保正确的驱动程序来访问每个数据源。该驱动程序管理器能够支持连接到多个异构数据库的多个并发的驱动程序。\n\n以下是结构图，其中显示了驱动程序管理器相对于在 JDBC  驱动程序和 Java  应用程序所处的位置。\n![JDBC](/Users/wangwc/Pictures/blogtmp/JDBC.jpg)\n\n## API 与类概述\n> JDBC API 主要位于JDK 中的java.sql 包中（之后扩展的内容位于javax.sql 包中），主要包括（斜体代表接口，需驱动程序提供者来具体实现）：\n\n> `DriverManager` ：负责加载各种不同驱动程序（Driver ），并根据不同的请求，向调用者返回相应的数据库连接（Connection ）。\n> `Driver` ：驱动程序，会将自身加载到DriverManager 中去，并处理相应的请求并返回相应的数据库连接（Connection ）。\n> `Connection` ：数据库连接，负责进行与数据库间的通讯，SQL 执行以及事务处理都是在某个特定Connection 环境中进行的。可以产生用以执行SQL 的Statement 。\n> **`Statement` ：用以执行SQL 查询和更新（针对静态SQL 语句和单次执行）。\n> `PreparedStatement` ：用以执行包含动态参数的SQL 查询和更新（在服务器端编译，允许重复执行以提高效率）。\n> `CallableStatement` ：用以调用数据库中的存储过程。**\n> `SQLException` ：代表在数据库连接的创建和关闭和SQL语句的执行过程中发生了例外情况（即错误）。\n> 摘自 wikipedia，Java数据库连接，https://zh.wikipedia.org/wiki/Java%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5\n\n除了以上 API ，JDBC  还提供了以下类：\n\n`ResultSet`  : 在你使用语句对象执行 SQL  查询后，这些对象保存从数据获得的数据。它作为一个迭代器，让您可以通过它的数据来移动。\n\n## JDBC 使用基本思路\n1. 制作到数据库的连接。\n2. 创建 SQL 或 MySQL 语句。\n3. 执行 SQL 或 MySQL 查询数据库。\n4. 查看和修改所产生的记录。\n\n# J2SE 通过 JDBC 连接数据库\n## 前期准备\n1. 安装完成 Java\n2. 部署好数据库，以下采用的是 MySQL  数据库\n3. 下载相关驱动，MySQL 的 JDBC 驱动为使用的是 mysql-connector-java-5.1.32-bin.jar ，[下载地址](https://dev.mysql.com/downloads/connector/j/3.1.html)\n\n## 创建 JDBC 应用程序\n1. 导入数据包 . 需要包括含有需要进行数据库编程的JDBC类 的包。大多数情况下，使用 import java.sql.*  就可以了.\n2. 注册JDBC驱动程序 . 需要初始化驱动程序，可以与数据库打开一个通信通道。\n3. 打开连接. 需要使用DriverManager.getConnection()  方法创建一个Connection 对象，它代表与数据库的物理连接。\n4. 执行查询 . 需要使用类型声明的对象建立并提交一个SQL 语句到数据库。\n5. 从结果集中提取数据 . 要求使用适当的关于ResultSet.getXXX() 方法来检索结果集的数据。\n6. 清理环境. 需要明确地关闭所有的数据库资源相对依靠JVM 的垃圾收集。\n\n```java\n/** STEP 1. Import required packages 导入数据包 */\nimport java.sql.*;\n\npublic class JDBCExample {\n    /** JDBC driver name and database URL\n     *  定义 JDBC 驱动以及数据库地址，此处数据库为本地的 test */\n    static final String JDBC_DRIVER = \"com.mysql.jdbc.Driver\";\n    static final String DB_URL = \"jdbc:mysql://localhost/test\";\n\n    /**  Database credentials\n     *   数据库的账号、密码\n     *   */\n    static final String USER = \"root\";\n    static final String PASS = \"\";\n\n    public static void main(String[] args) {\n        Connection conn = null;\n        Statement stmt = null;\n        try{\n            /** STEP 2: Register JDBC driver\n             * 加载 JDBC 驱动程序 Driver 至 DriverManager */\n            Class.forName(JDBC_DRIVER);\n\n            /** STEP 3: Open a connection\n             *  通过 DB_URL, 数据库账号和密码来获取相应的数据库连接 */\n            System.out.println(\"Connecting to database...\");\n            conn = DriverManager.getConnection(DB_URL,USER,PASS);\n\n            /** STEP 4: Execute a query\n             *  获取 connection 之后，可以创建 Statement 用来执行 SQL 语句\n             *  其中 结果存储在 ResultSet 结果集 */\n            System.out.println(\"Creating statement...\");\n            stmt = conn.createStatement();\n            String sql;\n            sql = \"SELECT * FROM t_user\";\n            ResultSet rs = stmt.executeQuery(sql);\n\n            /** STEP 5: Extract data from result set\n             *  通过遍历结果集顺序访问数据\n             *  具体是 getInt 还是 getString，请参考附录一：SQL 到 Java 的数据类型的映射*/\n            while(rs.next()){\n                //Retrieve by column name\n                int id  = rs.getInt(\"id\");\n                String name = rs.getString(\"name\");\n                int age = rs.getInt(\"age\");\n                int gender = rs.getInt(\"gender\");\n\n                //Display values\n                System.out.println(\"ID: \" + id + \", Name: \" + name\n                        + \", Age: \" + age + \", Gender: \" + gender);\n            }\n            /** STEP 6: Clean-up environment\n             * 清理环境，需要关闭结果集、Statement 以及数据库连接\n             * 注意！关闭的顺序！*/\n            rs.close();\n            stmt.close();\n            conn.close();\n        }catch(SQLException se){\n            /** Handle errors for JDBC\n             * 如果数据库操作失败，JDBC将抛出一个SQLException。\n             * 一般来说，此类异常很少能够恢复，唯一能做的就是尽可能详细的打印异常日记。\n             * 推荐的做法是将SQLException翻译成应用程序领域相关的异常（非强制处理异\n             * 常）并最终回滚数据库和通知用户。*/\n            se.printStackTrace();\n        }catch(Exception e){\n            //Handle errors for Class.forName\n            e.printStackTrace();\n        }finally{\n            //finally block used to close resources\n            try{\n                if(stmt!=null)\n                    stmt.close();\n            }catch(SQLException se2){\n            }// nothing we can do\n            try{\n                if(conn!=null)\n                    conn.close();\n            }catch(SQLException se){\n                se.printStackTrace();\n            }\n        }\n        System.out.println(\"Goodbye!\");\n    }\n}\n```\n以上一例为模板，以下例子仅填充\n```java\nConnection conn = null;\nStatement stmt = null;\nPreparedStatement pstmt = null;\n\ntry {\n\tClass.forName(JDBC_DRIVER);\n\tconn = DriverManager.getConnection(DB_URL, USER, PASS);\n\n\t/* 在此填充代码 */\n\n} catch (ClassNotFoundException e) {\n\te.printStackTrace();\n} catch (SQLException e) {\n\te.printStackTrace();\n} finally {\n\ttry {\n\t\tif (stmt != null)\n\t\t\tstmt.close();\n\t} catch (SQLException se2) {\n\t\ttry {\n\t\t\tif (conn != null)\n\t\t\t\tconn.close();\n\t\t} catch (SQLException se) {\n\t\t\tse.printStackTrace();\n\t\t}\n\t}\n}\n```\n### Example 1：executeQuery()，仅单行数据\n返回一个 ResultSet 对象。当希望得到一个结果集时使用该方法，如使用 SELECT 语句。\n```java\n//////// Example 1: statement, executeQuery\nstmt = conn.createStatement();\nString sql1 = \"SELECT COUNT(DISTINCT `name`) AS 'cnt' FROM `user`\";\nResultSet rs = stmt.executeQuery(sql1);\n\nwhile (rs.next()) {\n\tint cnt1 = rs.getInt(1); // 此处的 column，第一列下标为 1，而非 0\n\tint cnt2 = rs.getInt(\"cnt\");\n\tSystem.out.println(\"count: \" + cnt1 + \", \" + cnt2);\n}\nrs.close();\n```\n\n### Example 2：executeUpdate()\n返回执行 SQL 语句影响的行的数目。使用该方法来执行 SQL 语句，得到一些受影响的行的数目，例如，INSERT，UPDATE 或 DELETE 语句\n```java\n//////// Example 2: statement, executeUpdate\nString sql2 = \"INSERT INTO `user`(name, age) VALUES ('noname', 30)\";\nint ret2 = stmt.executeUpdate(sql2);\n```\n\n### Example 3：execute()\n如果 ResultSet 对象可以被检索，则返回的布尔值为 true ，否则返回 false 。当需要使用真正的动态 SQL 时，可以使用这个方法来执行 SQL DDL 语句。\n```java\n//////// Example 3: statement, execute\nString sql3 = \"CREATE TABLE tmp(id int,name VARCHAR(255))\";\nboolean ret3 = stmt.execute(sql3);\n```\n### Example 4：PrepareStatement\n使用问号作为参数的标示。进行参数设置与大部分Java API中下标的使用方法不同，字段的下标从1开始，1代表第一个问号\n```java\n/////// Example 4: preparedStatement\nString sql4 = \"SELECT * FROM `user` WHERE name=? AND age=?\";\npstmt = conn.prepareStatement(sql4);\npstmt.setString(1, \"test\");\npstmt.setInt(2, 10);\nResultSet rs4 = pstmt.executeQuery();\nwhile (rs4.next()) {\n\tString name = rs4.getString(\"name\");\n\tint age = rs4.getInt(\"age\");\n\tSystem.out.println(\"Name: \" + name + \", \" + \"Age: \" + age);\n}\nrs4.close();\n```\n### Example 5：JDBC 下的事务\n```java\n///////// Example 5: 事务与回滚 transaction and rollback\nboolean autoCommitDefault = false;\nSavepoint savepoint1 = null;\nSavepoint savepoint2 = null;\ntry {\n\tClass.forName(JDBC_DRIVER);\n\tconn = DriverManager.getConnection(DB_URL, USER, PASS);\n\n\tautoCommitDefault = conn.getAutoCommit();\n\t// 关闭自动提交，数据库默认时，是自动提交的\n\tconn.setAutoCommit(false);\n\tstmt = conn.createStatement();\n\n\tString sql5 = \"SELECT * FROM `user` WHERE age=10\";\n\tString sql6 = \"INSERT INTO `user`(name, age) VALUES ('name1',1),('name2', 2)\";\n\tString sql7 = \"UPDATE `user` SET `name`='newname' WHERE age=10\";\n\tstmt.executeQuery(sql5);\n\tsavepoint1 = conn.setSavepoint(\"Savepoint1\");\n\tstmt.executeUpdate(sql6);\n\tsavepoint2 = conn.setSavepoint(\"Savepoint2\");\n\tstmt.executeUpdate(sql7);\n\tconn.commit();\n\n} catch (Throwable e) {\n\ttry {\n\t\t// 回滚, 至 savepoint2. savepoint 非必须\n\t\tconn.rollback(savepoint2);\n\t} catch (Throwable ignore) {}\n\tthrow e;\n} finally {\n\ttry {\n\t\t// 将 commit 设回默认值\n\t\tconn.setAutoCommit(autoCommitDefault);\n\t} catch (Throwable ignore) {}\n\n\ttry {\n\t\tif (stmt != null)\n\t\t\tstmt.close();\n\t} catch (SQLException se2) {\n\t\ttry {\n\t\t\tif (conn != null)\n\t\t\t\tconn.close();\n\t\t} catch (SQLException se) {\n\t\t\tse.printStackTrace();\n\t\t}\n\t}\n}\n```\n### Example 6：JDBC 下的存储过程\n** TODO **\n```java\n/*\n * 有IN 类型的参数输入 和Out类型的参数输出\t\n */\npublic static void inOutTest(){\n\tConnection connection = null;\n\tStatement statement = null;\n\tResultSet resultSet = null;\n\ttry {\n\t\t\n\t\tClass.forName(\"oracle.jdbc.driver.OracleDriver\").newInstance();\n\t\t\n\t\tDriver driver = DriverManager.getDriver(URL);\n\t\tProperties props = new Properties();\n\t\tprops.put(\"user\", USER_NAME);\n\t\tprops.put(\"password\", PASSWORD);\n\t\t\n\t\tconnection = driver.connect(URL, props);\n\t\t\n\t\t//获得Statement对象,这里使用了事务机制，如果创建存储过程语句失败或者是执行compile失败，回退\n\t\tconnection.setAutoCommit(false);\n\t\tstatement = connection.createStatement();\n\t\tString procedureString = \"CREATE OR REPLACE PROCEDURE get_job_min_salary_proc(\"\n\t\t\t\t\t\t\t\t\t+\"input_job_id IN VARCHAR2,\"\n\t\t\t\t\t\t\t\t\t+\"output_salary OUT number) AS \"\n\t\t\t\t\t\t\t\t\t+\"BEGIN \"\n\t\t\t\t\t\t\t\t\t+\"SELECT min_salary INTO output_salary FROM jobs WHERE job_id = input_job_id; \"\n\t\t\t\t\t\t\t\t\t+\"END   get_job_min_salary_proc;\";\n\t\t//1 创建存储过程,JDBC 数据库会编译存储过程\n\t\tstatement.execute(procedureString);\n\t\t//成功则提交\n\t\tconnection.commit();\n\t\t//2.创建callableStatement\n\t    CallableStatement callableStatement = connection.prepareCall(\"CALL get_job_min_salary_proc(?,?)\");\n\t    //3，设置in参数\n\t    callableStatement.setString(1, \"AD_PRES\");\n\t    //4.注册输出参数\n\t    callableStatement.registerOutParameter(2, Types.NUMERIC);\n\t    //5.执行语句\n\t    callableStatement.execute();\n\t    \n\t    BigDecimal salary = callableStatement.getBigDecimal(2);\n\t    System.out.println(salary);\n\t\t\n\t} catch (ClassNotFoundException e) {\n\t\tSystem.out.println(\"加载Oracle类失败！\");\n\t\te.printStackTrace();\n\t} catch (SQLException e) {\n\t\ttry {\n\t\t\tconnection.rollback();\n\t\t} catch (SQLException e1) {\n\t\t\te1.printStackTrace();\n\t\t}\n\t\te.printStackTrace();\n\t} catch (InstantiationException e) {\n\t\te.printStackTrace();\n\t} catch (IllegalAccessException e) {\n\t\te.printStackTrace();\n\t}finally{\n\t\t    //使用完成后管理链接，释放资源，释放顺序应该是： ResultSet ->Statement ->Connection\n\t\t\t\n\t\t\ttry {\n\t\t\t\tstatement.close();\n\t\t\t} catch (SQLException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t\t\n\t\t\ttry {\n\t\t\t\tconnection.close();\n\t\t\t} catch (SQLException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t}\n}\n```\n\n\n","source":"_posts/漫谈-JDBC-以及与-Spring-之整合.md","raw":"---\ntitle: 漫谈 JDBC 以及与 Spring 之整合\ndate: 2016-10-14 22:54:38\ntags: \n- JDBC\n- Spring\n---\n\n# 介绍 JDBC\nJDBC  是 Java 数据库连接（Java Database Connectivity）的简称，是Java语言中用来规范客户端程序如何来访问数据库的应用程序接口，用来连接 Java 与数据库，提供了诸如查询和更新数据库中数据的方法。\n\n## JDBC 架构\nJDBC  的 API  支持两层和三层处理模式进行数据库访问，但一般的 JDBC  架构由两层处理模式组成：\n\n* JDBC API : 提供了应用程序对 JDBC  管理器的连接。\n* JDBC Driver API : 提供了 JDBC  管理器对驱动程序连接。\n\nJDBC API  使用驱动程序管理器和数据库特定的驱动程序来提供异构（heterogeneous）数据库的透明连接。\n\nJDBC  驱动程序管理器可确保正确的驱动程序来访问每个数据源。该驱动程序管理器能够支持连接到多个异构数据库的多个并发的驱动程序。\n\n以下是结构图，其中显示了驱动程序管理器相对于在 JDBC  驱动程序和 Java  应用程序所处的位置。\n![JDBC](/Users/wangwc/Pictures/blogtmp/JDBC.jpg)\n\n## API 与类概述\n> JDBC API 主要位于JDK 中的java.sql 包中（之后扩展的内容位于javax.sql 包中），主要包括（斜体代表接口，需驱动程序提供者来具体实现）：\n\n> `DriverManager` ：负责加载各种不同驱动程序（Driver ），并根据不同的请求，向调用者返回相应的数据库连接（Connection ）。\n> `Driver` ：驱动程序，会将自身加载到DriverManager 中去，并处理相应的请求并返回相应的数据库连接（Connection ）。\n> `Connection` ：数据库连接，负责进行与数据库间的通讯，SQL 执行以及事务处理都是在某个特定Connection 环境中进行的。可以产生用以执行SQL 的Statement 。\n> **`Statement` ：用以执行SQL 查询和更新（针对静态SQL 语句和单次执行）。\n> `PreparedStatement` ：用以执行包含动态参数的SQL 查询和更新（在服务器端编译，允许重复执行以提高效率）。\n> `CallableStatement` ：用以调用数据库中的存储过程。**\n> `SQLException` ：代表在数据库连接的创建和关闭和SQL语句的执行过程中发生了例外情况（即错误）。\n> 摘自 wikipedia，Java数据库连接，https://zh.wikipedia.org/wiki/Java%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5\n\n除了以上 API ，JDBC  还提供了以下类：\n\n`ResultSet`  : 在你使用语句对象执行 SQL  查询后，这些对象保存从数据获得的数据。它作为一个迭代器，让您可以通过它的数据来移动。\n\n## JDBC 使用基本思路\n1. 制作到数据库的连接。\n2. 创建 SQL 或 MySQL 语句。\n3. 执行 SQL 或 MySQL 查询数据库。\n4. 查看和修改所产生的记录。\n\n# J2SE 通过 JDBC 连接数据库\n## 前期准备\n1. 安装完成 Java\n2. 部署好数据库，以下采用的是 MySQL  数据库\n3. 下载相关驱动，MySQL 的 JDBC 驱动为使用的是 mysql-connector-java-5.1.32-bin.jar ，[下载地址](https://dev.mysql.com/downloads/connector/j/3.1.html)\n\n## 创建 JDBC 应用程序\n1. 导入数据包 . 需要包括含有需要进行数据库编程的JDBC类 的包。大多数情况下，使用 import java.sql.*  就可以了.\n2. 注册JDBC驱动程序 . 需要初始化驱动程序，可以与数据库打开一个通信通道。\n3. 打开连接. 需要使用DriverManager.getConnection()  方法创建一个Connection 对象，它代表与数据库的物理连接。\n4. 执行查询 . 需要使用类型声明的对象建立并提交一个SQL 语句到数据库。\n5. 从结果集中提取数据 . 要求使用适当的关于ResultSet.getXXX() 方法来检索结果集的数据。\n6. 清理环境. 需要明确地关闭所有的数据库资源相对依靠JVM 的垃圾收集。\n\n```java\n/** STEP 1. Import required packages 导入数据包 */\nimport java.sql.*;\n\npublic class JDBCExample {\n    /** JDBC driver name and database URL\n     *  定义 JDBC 驱动以及数据库地址，此处数据库为本地的 test */\n    static final String JDBC_DRIVER = \"com.mysql.jdbc.Driver\";\n    static final String DB_URL = \"jdbc:mysql://localhost/test\";\n\n    /**  Database credentials\n     *   数据库的账号、密码\n     *   */\n    static final String USER = \"root\";\n    static final String PASS = \"\";\n\n    public static void main(String[] args) {\n        Connection conn = null;\n        Statement stmt = null;\n        try{\n            /** STEP 2: Register JDBC driver\n             * 加载 JDBC 驱动程序 Driver 至 DriverManager */\n            Class.forName(JDBC_DRIVER);\n\n            /** STEP 3: Open a connection\n             *  通过 DB_URL, 数据库账号和密码来获取相应的数据库连接 */\n            System.out.println(\"Connecting to database...\");\n            conn = DriverManager.getConnection(DB_URL,USER,PASS);\n\n            /** STEP 4: Execute a query\n             *  获取 connection 之后，可以创建 Statement 用来执行 SQL 语句\n             *  其中 结果存储在 ResultSet 结果集 */\n            System.out.println(\"Creating statement...\");\n            stmt = conn.createStatement();\n            String sql;\n            sql = \"SELECT * FROM t_user\";\n            ResultSet rs = stmt.executeQuery(sql);\n\n            /** STEP 5: Extract data from result set\n             *  通过遍历结果集顺序访问数据\n             *  具体是 getInt 还是 getString，请参考附录一：SQL 到 Java 的数据类型的映射*/\n            while(rs.next()){\n                //Retrieve by column name\n                int id  = rs.getInt(\"id\");\n                String name = rs.getString(\"name\");\n                int age = rs.getInt(\"age\");\n                int gender = rs.getInt(\"gender\");\n\n                //Display values\n                System.out.println(\"ID: \" + id + \", Name: \" + name\n                        + \", Age: \" + age + \", Gender: \" + gender);\n            }\n            /** STEP 6: Clean-up environment\n             * 清理环境，需要关闭结果集、Statement 以及数据库连接\n             * 注意！关闭的顺序！*/\n            rs.close();\n            stmt.close();\n            conn.close();\n        }catch(SQLException se){\n            /** Handle errors for JDBC\n             * 如果数据库操作失败，JDBC将抛出一个SQLException。\n             * 一般来说，此类异常很少能够恢复，唯一能做的就是尽可能详细的打印异常日记。\n             * 推荐的做法是将SQLException翻译成应用程序领域相关的异常（非强制处理异\n             * 常）并最终回滚数据库和通知用户。*/\n            se.printStackTrace();\n        }catch(Exception e){\n            //Handle errors for Class.forName\n            e.printStackTrace();\n        }finally{\n            //finally block used to close resources\n            try{\n                if(stmt!=null)\n                    stmt.close();\n            }catch(SQLException se2){\n            }// nothing we can do\n            try{\n                if(conn!=null)\n                    conn.close();\n            }catch(SQLException se){\n                se.printStackTrace();\n            }\n        }\n        System.out.println(\"Goodbye!\");\n    }\n}\n```\n以上一例为模板，以下例子仅填充\n```java\nConnection conn = null;\nStatement stmt = null;\nPreparedStatement pstmt = null;\n\ntry {\n\tClass.forName(JDBC_DRIVER);\n\tconn = DriverManager.getConnection(DB_URL, USER, PASS);\n\n\t/* 在此填充代码 */\n\n} catch (ClassNotFoundException e) {\n\te.printStackTrace();\n} catch (SQLException e) {\n\te.printStackTrace();\n} finally {\n\ttry {\n\t\tif (stmt != null)\n\t\t\tstmt.close();\n\t} catch (SQLException se2) {\n\t\ttry {\n\t\t\tif (conn != null)\n\t\t\t\tconn.close();\n\t\t} catch (SQLException se) {\n\t\t\tse.printStackTrace();\n\t\t}\n\t}\n}\n```\n### Example 1：executeQuery()，仅单行数据\n返回一个 ResultSet 对象。当希望得到一个结果集时使用该方法，如使用 SELECT 语句。\n```java\n//////// Example 1: statement, executeQuery\nstmt = conn.createStatement();\nString sql1 = \"SELECT COUNT(DISTINCT `name`) AS 'cnt' FROM `user`\";\nResultSet rs = stmt.executeQuery(sql1);\n\nwhile (rs.next()) {\n\tint cnt1 = rs.getInt(1); // 此处的 column，第一列下标为 1，而非 0\n\tint cnt2 = rs.getInt(\"cnt\");\n\tSystem.out.println(\"count: \" + cnt1 + \", \" + cnt2);\n}\nrs.close();\n```\n\n### Example 2：executeUpdate()\n返回执行 SQL 语句影响的行的数目。使用该方法来执行 SQL 语句，得到一些受影响的行的数目，例如，INSERT，UPDATE 或 DELETE 语句\n```java\n//////// Example 2: statement, executeUpdate\nString sql2 = \"INSERT INTO `user`(name, age) VALUES ('noname', 30)\";\nint ret2 = stmt.executeUpdate(sql2);\n```\n\n### Example 3：execute()\n如果 ResultSet 对象可以被检索，则返回的布尔值为 true ，否则返回 false 。当需要使用真正的动态 SQL 时，可以使用这个方法来执行 SQL DDL 语句。\n```java\n//////// Example 3: statement, execute\nString sql3 = \"CREATE TABLE tmp(id int,name VARCHAR(255))\";\nboolean ret3 = stmt.execute(sql3);\n```\n### Example 4：PrepareStatement\n使用问号作为参数的标示。进行参数设置与大部分Java API中下标的使用方法不同，字段的下标从1开始，1代表第一个问号\n```java\n/////// Example 4: preparedStatement\nString sql4 = \"SELECT * FROM `user` WHERE name=? AND age=?\";\npstmt = conn.prepareStatement(sql4);\npstmt.setString(1, \"test\");\npstmt.setInt(2, 10);\nResultSet rs4 = pstmt.executeQuery();\nwhile (rs4.next()) {\n\tString name = rs4.getString(\"name\");\n\tint age = rs4.getInt(\"age\");\n\tSystem.out.println(\"Name: \" + name + \", \" + \"Age: \" + age);\n}\nrs4.close();\n```\n### Example 5：JDBC 下的事务\n```java\n///////// Example 5: 事务与回滚 transaction and rollback\nboolean autoCommitDefault = false;\nSavepoint savepoint1 = null;\nSavepoint savepoint2 = null;\ntry {\n\tClass.forName(JDBC_DRIVER);\n\tconn = DriverManager.getConnection(DB_URL, USER, PASS);\n\n\tautoCommitDefault = conn.getAutoCommit();\n\t// 关闭自动提交，数据库默认时，是自动提交的\n\tconn.setAutoCommit(false);\n\tstmt = conn.createStatement();\n\n\tString sql5 = \"SELECT * FROM `user` WHERE age=10\";\n\tString sql6 = \"INSERT INTO `user`(name, age) VALUES ('name1',1),('name2', 2)\";\n\tString sql7 = \"UPDATE `user` SET `name`='newname' WHERE age=10\";\n\tstmt.executeQuery(sql5);\n\tsavepoint1 = conn.setSavepoint(\"Savepoint1\");\n\tstmt.executeUpdate(sql6);\n\tsavepoint2 = conn.setSavepoint(\"Savepoint2\");\n\tstmt.executeUpdate(sql7);\n\tconn.commit();\n\n} catch (Throwable e) {\n\ttry {\n\t\t// 回滚, 至 savepoint2. savepoint 非必须\n\t\tconn.rollback(savepoint2);\n\t} catch (Throwable ignore) {}\n\tthrow e;\n} finally {\n\ttry {\n\t\t// 将 commit 设回默认值\n\t\tconn.setAutoCommit(autoCommitDefault);\n\t} catch (Throwable ignore) {}\n\n\ttry {\n\t\tif (stmt != null)\n\t\t\tstmt.close();\n\t} catch (SQLException se2) {\n\t\ttry {\n\t\t\tif (conn != null)\n\t\t\t\tconn.close();\n\t\t} catch (SQLException se) {\n\t\t\tse.printStackTrace();\n\t\t}\n\t}\n}\n```\n### Example 6：JDBC 下的存储过程\n** TODO **\n```java\n/*\n * 有IN 类型的参数输入 和Out类型的参数输出\t\n */\npublic static void inOutTest(){\n\tConnection connection = null;\n\tStatement statement = null;\n\tResultSet resultSet = null;\n\ttry {\n\t\t\n\t\tClass.forName(\"oracle.jdbc.driver.OracleDriver\").newInstance();\n\t\t\n\t\tDriver driver = DriverManager.getDriver(URL);\n\t\tProperties props = new Properties();\n\t\tprops.put(\"user\", USER_NAME);\n\t\tprops.put(\"password\", PASSWORD);\n\t\t\n\t\tconnection = driver.connect(URL, props);\n\t\t\n\t\t//获得Statement对象,这里使用了事务机制，如果创建存储过程语句失败或者是执行compile失败，回退\n\t\tconnection.setAutoCommit(false);\n\t\tstatement = connection.createStatement();\n\t\tString procedureString = \"CREATE OR REPLACE PROCEDURE get_job_min_salary_proc(\"\n\t\t\t\t\t\t\t\t\t+\"input_job_id IN VARCHAR2,\"\n\t\t\t\t\t\t\t\t\t+\"output_salary OUT number) AS \"\n\t\t\t\t\t\t\t\t\t+\"BEGIN \"\n\t\t\t\t\t\t\t\t\t+\"SELECT min_salary INTO output_salary FROM jobs WHERE job_id = input_job_id; \"\n\t\t\t\t\t\t\t\t\t+\"END   get_job_min_salary_proc;\";\n\t\t//1 创建存储过程,JDBC 数据库会编译存储过程\n\t\tstatement.execute(procedureString);\n\t\t//成功则提交\n\t\tconnection.commit();\n\t\t//2.创建callableStatement\n\t    CallableStatement callableStatement = connection.prepareCall(\"CALL get_job_min_salary_proc(?,?)\");\n\t    //3，设置in参数\n\t    callableStatement.setString(1, \"AD_PRES\");\n\t    //4.注册输出参数\n\t    callableStatement.registerOutParameter(2, Types.NUMERIC);\n\t    //5.执行语句\n\t    callableStatement.execute();\n\t    \n\t    BigDecimal salary = callableStatement.getBigDecimal(2);\n\t    System.out.println(salary);\n\t\t\n\t} catch (ClassNotFoundException e) {\n\t\tSystem.out.println(\"加载Oracle类失败！\");\n\t\te.printStackTrace();\n\t} catch (SQLException e) {\n\t\ttry {\n\t\t\tconnection.rollback();\n\t\t} catch (SQLException e1) {\n\t\t\te1.printStackTrace();\n\t\t}\n\t\te.printStackTrace();\n\t} catch (InstantiationException e) {\n\t\te.printStackTrace();\n\t} catch (IllegalAccessException e) {\n\t\te.printStackTrace();\n\t}finally{\n\t\t    //使用完成后管理链接，释放资源，释放顺序应该是： ResultSet ->Statement ->Connection\n\t\t\t\n\t\t\ttry {\n\t\t\t\tstatement.close();\n\t\t\t} catch (SQLException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t\t\n\t\t\ttry {\n\t\t\t\tconnection.close();\n\t\t\t} catch (SQLException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t}\n}\n```\n\n\n","slug":"漫谈-JDBC-以及与-Spring-之整合","published":1,"updated":"2016-10-15T07:38:03.000Z","_id":"ciua0m28300050inuik74wfp0","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"介绍-JDBC\"><a href=\"#介绍-JDBC\" class=\"headerlink\" title=\"介绍 JDBC\"></a>介绍 JDBC</h1><p>JDBC  是 Java 数据库连接（Java Database Connectivity）的简称，是Java语言中用来规范客户端程序如何来访问数据库的应用程序接口，用来连接 Java 与数据库，提供了诸如查询和更新数据库中数据的方法。</p>\n<h2 id=\"JDBC-架构\"><a href=\"#JDBC-架构\" class=\"headerlink\" title=\"JDBC 架构\"></a>JDBC 架构</h2><p>JDBC  的 API  支持两层和三层处理模式进行数据库访问，但一般的 JDBC  架构由两层处理模式组成：</p>\n<ul>\n<li>JDBC API : 提供了应用程序对 JDBC  管理器的连接。</li>\n<li>JDBC Driver API : 提供了 JDBC  管理器对驱动程序连接。</li>\n</ul>\n<p>JDBC API  使用驱动程序管理器和数据库特定的驱动程序来提供异构（heterogeneous）数据库的透明连接。</p>\n<p>JDBC  驱动程序管理器可确保正确的驱动程序来访问每个数据源。该驱动程序管理器能够支持连接到多个异构数据库的多个并发的驱动程序。</p>\n<p>以下是结构图，其中显示了驱动程序管理器相对于在 JDBC  驱动程序和 Java  应用程序所处的位置。<br><img src=\"/Users/wangwc/Pictures/blogtmp/JDBC.jpg\" alt=\"JDBC\"></p>\n<h2 id=\"API-与类概述\"><a href=\"#API-与类概述\" class=\"headerlink\" title=\"API 与类概述\"></a>API 与类概述</h2><blockquote>\n<p>JDBC API 主要位于JDK 中的java.sql 包中（之后扩展的内容位于javax.sql 包中），主要包括（斜体代表接口，需驱动程序提供者来具体实现）：</p>\n<p><code>DriverManager</code> ：负责加载各种不同驱动程序（Driver ），并根据不同的请求，向调用者返回相应的数据库连接（Connection ）。<br><code>Driver</code> ：驱动程序，会将自身加载到DriverManager 中去，并处理相应的请求并返回相应的数据库连接（Connection ）。<br><code>Connection</code> ：数据库连接，负责进行与数据库间的通讯，SQL 执行以及事务处理都是在某个特定Connection 环境中进行的。可以产生用以执行SQL 的Statement 。<br><strong><code>Statement</code> ：用以执行SQL 查询和更新（针对静态SQL 语句和单次执行）。<br><code>PreparedStatement</code> ：用以执行包含动态参数的SQL 查询和更新（在服务器端编译，允许重复执行以提高效率）。<br><code>CallableStatement</code> ：用以调用数据库中的存储过程。</strong><br><code>SQLException</code> ：代表在数据库连接的创建和关闭和SQL语句的执行过程中发生了例外情况（即错误）。<br>摘自 wikipedia，Java数据库连接，<a href=\"https://zh.wikipedia.org/wiki/Java%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5\" target=\"_blank\" rel=\"external\">https://zh.wikipedia.org/wiki/Java%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5</a></p>\n</blockquote>\n<p>除了以上 API ，JDBC  还提供了以下类：</p>\n<p><code>ResultSet</code>  : 在你使用语句对象执行 SQL  查询后，这些对象保存从数据获得的数据。它作为一个迭代器，让您可以通过它的数据来移动。</p>\n<h2 id=\"JDBC-使用基本思路\"><a href=\"#JDBC-使用基本思路\" class=\"headerlink\" title=\"JDBC 使用基本思路\"></a>JDBC 使用基本思路</h2><ol>\n<li>制作到数据库的连接。</li>\n<li>创建 SQL 或 MySQL 语句。</li>\n<li>执行 SQL 或 MySQL 查询数据库。</li>\n<li>查看和修改所产生的记录。</li>\n</ol>\n<h1 id=\"J2SE-通过-JDBC-连接数据库\"><a href=\"#J2SE-通过-JDBC-连接数据库\" class=\"headerlink\" title=\"J2SE 通过 JDBC 连接数据库\"></a>J2SE 通过 JDBC 连接数据库</h1><h2 id=\"前期准备\"><a href=\"#前期准备\" class=\"headerlink\" title=\"前期准备\"></a>前期准备</h2><ol>\n<li>安装完成 Java</li>\n<li>部署好数据库，以下采用的是 MySQL  数据库</li>\n<li>下载相关驱动，MySQL 的 JDBC 驱动为使用的是 mysql-connector-java-5.1.32-bin.jar ，<a href=\"https://dev.mysql.com/downloads/connector/j/3.1.html\" target=\"_blank\" rel=\"external\">下载地址</a></li>\n</ol>\n<h2 id=\"创建-JDBC-应用程序\"><a href=\"#创建-JDBC-应用程序\" class=\"headerlink\" title=\"创建 JDBC 应用程序\"></a>创建 JDBC 应用程序</h2><ol>\n<li>导入数据包 . 需要包括含有需要进行数据库编程的JDBC类 的包。大多数情况下，使用 import java.sql.*  就可以了.</li>\n<li>注册JDBC驱动程序 . 需要初始化驱动程序，可以与数据库打开一个通信通道。</li>\n<li>打开连接. 需要使用DriverManager.getConnection()  方法创建一个Connection 对象，它代表与数据库的物理连接。</li>\n<li>执行查询 . 需要使用类型声明的对象建立并提交一个SQL 语句到数据库。</li>\n<li>从结果集中提取数据 . 要求使用适当的关于ResultSet.getXXX() 方法来检索结果集的数据。</li>\n<li>清理环境. 需要明确地关闭所有的数据库资源相对依靠JVM 的垃圾收集。</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/** STEP 1. Import required packages 导入数据包 */</span></div><div class=\"line\"><span class=\"keyword\">import</span> java.sql.*;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDBCExample</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">/** JDBC driver name and database URL</span></div><div class=\"line\">     *  定义 JDBC 驱动以及数据库地址，此处数据库为本地的 test */</div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String JDBC_DRIVER = <span class=\"string\">\"com.mysql.jdbc.Driver\"</span>;</div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String DB_URL = <span class=\"string\">\"jdbc:mysql://localhost/test\"</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/**  Database credentials</span></div><div class=\"line\">     *   数据库的账号、密码</div><div class=\"line\">     *   */</div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String USER = <span class=\"string\">\"root\"</span>;</div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String PASS = <span class=\"string\">\"\"</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</div><div class=\"line\">        Connection conn = <span class=\"keyword\">null</span>;</div><div class=\"line\">        Statement stmt = <span class=\"keyword\">null</span>;</div><div class=\"line\">        <span class=\"keyword\">try</span>&#123;</div><div class=\"line\">            <span class=\"comment\">/** STEP 2: Register JDBC driver</span></div><div class=\"line\">             * 加载 JDBC 驱动程序 Driver 至 DriverManager */</div><div class=\"line\">            Class.forName(JDBC_DRIVER);</div><div class=\"line\"></div><div class=\"line\">            <span class=\"comment\">/** STEP 3: Open a connection</span></div><div class=\"line\">             *  通过 DB_URL, 数据库账号和密码来获取相应的数据库连接 */</div><div class=\"line\">            System.out.println(<span class=\"string\">\"Connecting to database...\"</span>);</div><div class=\"line\">            conn = DriverManager.getConnection(DB_URL,USER,PASS);</div><div class=\"line\"></div><div class=\"line\">            <span class=\"comment\">/** STEP 4: Execute a query</span></div><div class=\"line\">             *  获取 connection 之后，可以创建 Statement 用来执行 SQL 语句</div><div class=\"line\">             *  其中 结果存储在 ResultSet 结果集 */</div><div class=\"line\">            System.out.println(<span class=\"string\">\"Creating statement...\"</span>);</div><div class=\"line\">            stmt = conn.createStatement();</div><div class=\"line\">            String sql;</div><div class=\"line\">            sql = <span class=\"string\">\"SELECT * FROM t_user\"</span>;</div><div class=\"line\">            ResultSet rs = stmt.executeQuery(sql);</div><div class=\"line\"></div><div class=\"line\">            <span class=\"comment\">/** STEP 5: Extract data from result set</span></div><div class=\"line\">             *  通过遍历结果集顺序访问数据</div><div class=\"line\">             *  具体是 getInt 还是 getString，请参考附录一：SQL 到 Java 的数据类型的映射*/</div><div class=\"line\">            <span class=\"keyword\">while</span>(rs.next())&#123;</div><div class=\"line\">                <span class=\"comment\">//Retrieve by column name</span></div><div class=\"line\">                <span class=\"keyword\">int</span> id  = rs.getInt(<span class=\"string\">\"id\"</span>);</div><div class=\"line\">                String name = rs.getString(<span class=\"string\">\"name\"</span>);</div><div class=\"line\">                <span class=\"keyword\">int</span> age = rs.getInt(<span class=\"string\">\"age\"</span>);</div><div class=\"line\">                <span class=\"keyword\">int</span> gender = rs.getInt(<span class=\"string\">\"gender\"</span>);</div><div class=\"line\"></div><div class=\"line\">                <span class=\"comment\">//Display values</span></div><div class=\"line\">                System.out.println(<span class=\"string\">\"ID: \"</span> + id + <span class=\"string\">\", Name: \"</span> + name</div><div class=\"line\">                        + <span class=\"string\">\", Age: \"</span> + age + <span class=\"string\">\", Gender: \"</span> + gender);</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"comment\">/** STEP 6: Clean-up environment</span></div><div class=\"line\">             * 清理环境，需要关闭结果集、Statement 以及数据库连接</div><div class=\"line\">             * 注意！关闭的顺序！*/</div><div class=\"line\">            rs.close();</div><div class=\"line\">            stmt.close();</div><div class=\"line\">            conn.close();</div><div class=\"line\">        &#125;<span class=\"keyword\">catch</span>(SQLException se)&#123;</div><div class=\"line\">            <span class=\"comment\">/** Handle errors for JDBC</span></div><div class=\"line\">             * 如果数据库操作失败，JDBC将抛出一个SQLException。</div><div class=\"line\">             * 一般来说，此类异常很少能够恢复，唯一能做的就是尽可能详细的打印异常日记。</div><div class=\"line\">             * 推荐的做法是将SQLException翻译成应用程序领域相关的异常（非强制处理异</div><div class=\"line\">             * 常）并最终回滚数据库和通知用户。*/</div><div class=\"line\">            se.printStackTrace();</div><div class=\"line\">        &#125;<span class=\"keyword\">catch</span>(Exception e)&#123;</div><div class=\"line\">            <span class=\"comment\">//Handle errors for Class.forName</span></div><div class=\"line\">            e.printStackTrace();</div><div class=\"line\">        &#125;<span class=\"keyword\">finally</span>&#123;</div><div class=\"line\">            <span class=\"comment\">//finally block used to close resources</span></div><div class=\"line\">            <span class=\"keyword\">try</span>&#123;</div><div class=\"line\">                <span class=\"keyword\">if</span>(stmt!=<span class=\"keyword\">null</span>)</div><div class=\"line\">                    stmt.close();</div><div class=\"line\">            &#125;<span class=\"keyword\">catch</span>(SQLException se2)&#123;</div><div class=\"line\">            &#125;<span class=\"comment\">// nothing we can do</span></div><div class=\"line\">            <span class=\"keyword\">try</span>&#123;</div><div class=\"line\">                <span class=\"keyword\">if</span>(conn!=<span class=\"keyword\">null</span>)</div><div class=\"line\">                    conn.close();</div><div class=\"line\">            &#125;<span class=\"keyword\">catch</span>(SQLException se)&#123;</div><div class=\"line\">                se.printStackTrace();</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"Goodbye!\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>以上一例为模板，以下例子仅填充<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\">Connection conn = <span class=\"keyword\">null</span>;</div><div class=\"line\">Statement stmt = <span class=\"keyword\">null</span>;</div><div class=\"line\">PreparedStatement pstmt = <span class=\"keyword\">null</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\tClass.forName(JDBC_DRIVER);</div><div class=\"line\">\tconn = DriverManager.getConnection(DB_URL, USER, PASS);</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/* 在此填充代码 */</span></div><div class=\"line\"></div><div class=\"line\">&#125; <span class=\"keyword\">catch</span> (ClassNotFoundException e) &#123;</div><div class=\"line\">\te.printStackTrace();</div><div class=\"line\">&#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</div><div class=\"line\">\te.printStackTrace();</div><div class=\"line\">&#125; <span class=\"keyword\">finally</span> &#123;</div><div class=\"line\">\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> (stmt != <span class=\"keyword\">null</span>)</div><div class=\"line\">\t\t\tstmt.close();</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (SQLException se2) &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (conn != <span class=\"keyword\">null</span>)</div><div class=\"line\">\t\t\t\tconn.close();</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (SQLException se) &#123;</div><div class=\"line\">\t\t\tse.printStackTrace();</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h3 id=\"Example-1：executeQuery-，仅单行数据\"><a href=\"#Example-1：executeQuery-，仅单行数据\" class=\"headerlink\" title=\"Example 1：executeQuery()，仅单行数据\"></a>Example 1：executeQuery()，仅单行数据</h3><p>返回一个 ResultSet 对象。当希望得到一个结果集时使用该方法，如使用 SELECT 语句。<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//////// Example 1: statement, executeQuery</span></div><div class=\"line\">stmt = conn.createStatement();</div><div class=\"line\">String sql1 = <span class=\"string\">\"SELECT COUNT(DISTINCT `name`) AS 'cnt' FROM `user`\"</span>;</div><div class=\"line\">ResultSet rs = stmt.executeQuery(sql1);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">while</span> (rs.next()) &#123;</div><div class=\"line\">\t<span class=\"keyword\">int</span> cnt1 = rs.getInt(<span class=\"number\">1</span>); <span class=\"comment\">// 此处的 column，第一列下标为 1，而非 0</span></div><div class=\"line\">\t<span class=\"keyword\">int</span> cnt2 = rs.getInt(<span class=\"string\">\"cnt\"</span>);</div><div class=\"line\">\tSystem.out.println(<span class=\"string\">\"count: \"</span> + cnt1 + <span class=\"string\">\", \"</span> + cnt2);</div><div class=\"line\">&#125;</div><div class=\"line\">rs.close();</div></pre></td></tr></table></figure></p>\n<h3 id=\"Example-2：executeUpdate\"><a href=\"#Example-2：executeUpdate\" class=\"headerlink\" title=\"Example 2：executeUpdate()\"></a>Example 2：executeUpdate()</h3><p>返回执行 SQL 语句影响的行的数目。使用该方法来执行 SQL 语句，得到一些受影响的行的数目，例如，INSERT，UPDATE 或 DELETE 语句<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//////// Example 2: statement, executeUpdate</span></div><div class=\"line\">String sql2 = <span class=\"string\">\"INSERT INTO `user`(name, age) VALUES ('noname', 30)\"</span>;</div><div class=\"line\"><span class=\"keyword\">int</span> ret2 = stmt.executeUpdate(sql2);</div></pre></td></tr></table></figure></p>\n<h3 id=\"Example-3：execute\"><a href=\"#Example-3：execute\" class=\"headerlink\" title=\"Example 3：execute()\"></a>Example 3：execute()</h3><p>如果 ResultSet 对象可以被检索，则返回的布尔值为 true ，否则返回 false 。当需要使用真正的动态 SQL 时，可以使用这个方法来执行 SQL DDL 语句。<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//////// Example 3: statement, execute</span></div><div class=\"line\">String sql3 = <span class=\"string\">\"CREATE TABLE tmp(id int,name VARCHAR(255))\"</span>;</div><div class=\"line\"><span class=\"keyword\">boolean</span> ret3 = stmt.execute(sql3);</div></pre></td></tr></table></figure></p>\n<h3 id=\"Example-4：PrepareStatement\"><a href=\"#Example-4：PrepareStatement\" class=\"headerlink\" title=\"Example 4：PrepareStatement\"></a>Example 4：PrepareStatement</h3><p>使用问号作为参数的标示。进行参数设置与大部分Java API中下标的使用方法不同，字段的下标从1开始，1代表第一个问号<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/////// Example 4: preparedStatement</span></div><div class=\"line\">String sql4 = <span class=\"string\">\"SELECT * FROM `user` WHERE name=? AND age=?\"</span>;</div><div class=\"line\">pstmt = conn.prepareStatement(sql4);</div><div class=\"line\">pstmt.setString(<span class=\"number\">1</span>, <span class=\"string\">\"test\"</span>);</div><div class=\"line\">pstmt.setInt(<span class=\"number\">2</span>, <span class=\"number\">10</span>);</div><div class=\"line\">ResultSet rs4 = pstmt.executeQuery();</div><div class=\"line\"><span class=\"keyword\">while</span> (rs4.next()) &#123;</div><div class=\"line\">\tString name = rs4.getString(<span class=\"string\">\"name\"</span>);</div><div class=\"line\">\t<span class=\"keyword\">int</span> age = rs4.getInt(<span class=\"string\">\"age\"</span>);</div><div class=\"line\">\tSystem.out.println(<span class=\"string\">\"Name: \"</span> + name + <span class=\"string\">\", \"</span> + <span class=\"string\">\"Age: \"</span> + age);</div><div class=\"line\">&#125;</div><div class=\"line\">rs4.close();</div></pre></td></tr></table></figure></p>\n<h3 id=\"Example-5：JDBC-下的事务\"><a href=\"#Example-5：JDBC-下的事务\" class=\"headerlink\" title=\"Example 5：JDBC 下的事务\"></a>Example 5：JDBC 下的事务</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">///////// Example 5: 事务与回滚 transaction and rollback</span></div><div class=\"line\"><span class=\"keyword\">boolean</span> autoCommitDefault = <span class=\"keyword\">false</span>;</div><div class=\"line\">Savepoint savepoint1 = <span class=\"keyword\">null</span>;</div><div class=\"line\">Savepoint savepoint2 = <span class=\"keyword\">null</span>;</div><div class=\"line\"><span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\tClass.forName(JDBC_DRIVER);</div><div class=\"line\">\tconn = DriverManager.getConnection(DB_URL, USER, PASS);</div><div class=\"line\"></div><div class=\"line\">\tautoCommitDefault = conn.getAutoCommit();</div><div class=\"line\">\t<span class=\"comment\">// 关闭自动提交，数据库默认时，是自动提交的</span></div><div class=\"line\">\tconn.setAutoCommit(<span class=\"keyword\">false</span>);</div><div class=\"line\">\tstmt = conn.createStatement();</div><div class=\"line\"></div><div class=\"line\">\tString sql5 = <span class=\"string\">\"SELECT * FROM `user` WHERE age=10\"</span>;</div><div class=\"line\">\tString sql6 = <span class=\"string\">\"INSERT INTO `user`(name, age) VALUES ('name1',1),('name2', 2)\"</span>;</div><div class=\"line\">\tString sql7 = <span class=\"string\">\"UPDATE `user` SET `name`='newname' WHERE age=10\"</span>;</div><div class=\"line\">\tstmt.executeQuery(sql5);</div><div class=\"line\">\tsavepoint1 = conn.setSavepoint(<span class=\"string\">\"Savepoint1\"</span>);</div><div class=\"line\">\tstmt.executeUpdate(sql6);</div><div class=\"line\">\tsavepoint2 = conn.setSavepoint(<span class=\"string\">\"Savepoint2\"</span>);</div><div class=\"line\">\tstmt.executeUpdate(sql7);</div><div class=\"line\">\tconn.commit();</div><div class=\"line\"></div><div class=\"line\">&#125; <span class=\"keyword\">catch</span> (Throwable e) &#123;</div><div class=\"line\">\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t<span class=\"comment\">// 回滚, 至 savepoint2. savepoint 非必须</span></div><div class=\"line\">\t\tconn.rollback(savepoint2);</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (Throwable ignore) &#123;&#125;</div><div class=\"line\">\t<span class=\"keyword\">throw</span> e;</div><div class=\"line\">&#125; <span class=\"keyword\">finally</span> &#123;</div><div class=\"line\">\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t<span class=\"comment\">// 将 commit 设回默认值</span></div><div class=\"line\">\t\tconn.setAutoCommit(autoCommitDefault);</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (Throwable ignore) &#123;&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> (stmt != <span class=\"keyword\">null</span>)</div><div class=\"line\">\t\t\tstmt.close();</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (SQLException se2) &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (conn != <span class=\"keyword\">null</span>)</div><div class=\"line\">\t\t\t\tconn.close();</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (SQLException se) &#123;</div><div class=\"line\">\t\t\tse.printStackTrace();</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"Example-6：JDBC-下的存储过程\"><a href=\"#Example-6：JDBC-下的存储过程\" class=\"headerlink\" title=\"Example 6：JDBC 下的存储过程\"></a>Example 6：JDBC 下的存储过程</h3><p><strong> TODO </strong><br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/*</span></div><div class=\"line\"> * 有IN 类型的参数输入 和Out类型的参数输出\t</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">inOutTest</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">\tConnection connection = <span class=\"keyword\">null</span>;</div><div class=\"line\">\tStatement statement = <span class=\"keyword\">null</span>;</div><div class=\"line\">\tResultSet resultSet = <span class=\"keyword\">null</span>;</div><div class=\"line\">\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t</div><div class=\"line\">\t\tClass.forName(<span class=\"string\">\"oracle.jdbc.driver.OracleDriver\"</span>).newInstance();</div><div class=\"line\">\t\t</div><div class=\"line\">\t\tDriver driver = DriverManager.getDriver(URL);</div><div class=\"line\">\t\tProperties props = <span class=\"keyword\">new</span> Properties();</div><div class=\"line\">\t\tprops.put(<span class=\"string\">\"user\"</span>, USER_NAME);</div><div class=\"line\">\t\tprops.put(<span class=\"string\">\"password\"</span>, PASSWORD);</div><div class=\"line\">\t\t</div><div class=\"line\">\t\tconnection = driver.connect(URL, props);</div><div class=\"line\">\t\t</div><div class=\"line\">\t\t<span class=\"comment\">//获得Statement对象,这里使用了事务机制，如果创建存储过程语句失败或者是执行compile失败，回退</span></div><div class=\"line\">\t\tconnection.setAutoCommit(<span class=\"keyword\">false</span>);</div><div class=\"line\">\t\tstatement = connection.createStatement();</div><div class=\"line\">\t\tString procedureString = <span class=\"string\">\"CREATE OR REPLACE PROCEDURE get_job_min_salary_proc(\"</span></div><div class=\"line\">\t\t\t\t\t\t\t\t\t+<span class=\"string\">\"input_job_id IN VARCHAR2,\"</span></div><div class=\"line\">\t\t\t\t\t\t\t\t\t+<span class=\"string\">\"output_salary OUT number) AS \"</span></div><div class=\"line\">\t\t\t\t\t\t\t\t\t+<span class=\"string\">\"BEGIN \"</span></div><div class=\"line\">\t\t\t\t\t\t\t\t\t+<span class=\"string\">\"SELECT min_salary INTO output_salary FROM jobs WHERE job_id = input_job_id; \"</span></div><div class=\"line\">\t\t\t\t\t\t\t\t\t+<span class=\"string\">\"END   get_job_min_salary_proc;\"</span>;</div><div class=\"line\">\t\t<span class=\"comment\">//1 创建存储过程,JDBC 数据库会编译存储过程</span></div><div class=\"line\">\t\tstatement.execute(procedureString);</div><div class=\"line\">\t\t<span class=\"comment\">//成功则提交</span></div><div class=\"line\">\t\tconnection.commit();</div><div class=\"line\">\t\t<span class=\"comment\">//2.创建callableStatement</span></div><div class=\"line\">\t    CallableStatement callableStatement = connection.prepareCall(<span class=\"string\">\"CALL get_job_min_salary_proc(?,?)\"</span>);</div><div class=\"line\">\t    <span class=\"comment\">//3，设置in参数</span></div><div class=\"line\">\t    callableStatement.setString(<span class=\"number\">1</span>, <span class=\"string\">\"AD_PRES\"</span>);</div><div class=\"line\">\t    <span class=\"comment\">//4.注册输出参数</span></div><div class=\"line\">\t    callableStatement.registerOutParameter(<span class=\"number\">2</span>, Types.NUMERIC);</div><div class=\"line\">\t    <span class=\"comment\">//5.执行语句</span></div><div class=\"line\">\t    callableStatement.execute();</div><div class=\"line\">\t    </div><div class=\"line\">\t    BigDecimal salary = callableStatement.getBigDecimal(<span class=\"number\">2</span>);</div><div class=\"line\">\t    System.out.println(salary);</div><div class=\"line\">\t\t</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (ClassNotFoundException e) &#123;</div><div class=\"line\">\t\tSystem.out.println(<span class=\"string\">\"加载Oracle类失败！\"</span>);</div><div class=\"line\">\t\te.printStackTrace();</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\tconnection.rollback();</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (SQLException e1) &#123;</div><div class=\"line\">\t\t\te1.printStackTrace();</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\te.printStackTrace();</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (InstantiationException e) &#123;</div><div class=\"line\">\t\te.printStackTrace();</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (IllegalAccessException e) &#123;</div><div class=\"line\">\t\te.printStackTrace();</div><div class=\"line\">\t&#125;<span class=\"keyword\">finally</span>&#123;</div><div class=\"line\">\t\t    <span class=\"comment\">//使用完成后管理链接，释放资源，释放顺序应该是： ResultSet -&gt;Statement -&gt;Connection</span></div><div class=\"line\">\t\t\t</div><div class=\"line\">\t\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\t\tstatement.close();</div><div class=\"line\">\t\t\t&#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</div><div class=\"line\">\t\t\t\te.printStackTrace();</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t\t</div><div class=\"line\">\t\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\t\tconnection.close();</div><div class=\"line\">\t\t\t&#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</div><div class=\"line\">\t\t\t\te.printStackTrace();</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n","excerpt":"","more":"<h1 id=\"介绍-JDBC\"><a href=\"#介绍-JDBC\" class=\"headerlink\" title=\"介绍 JDBC\"></a>介绍 JDBC</h1><p>JDBC  是 Java 数据库连接（Java Database Connectivity）的简称，是Java语言中用来规范客户端程序如何来访问数据库的应用程序接口，用来连接 Java 与数据库，提供了诸如查询和更新数据库中数据的方法。</p>\n<h2 id=\"JDBC-架构\"><a href=\"#JDBC-架构\" class=\"headerlink\" title=\"JDBC 架构\"></a>JDBC 架构</h2><p>JDBC  的 API  支持两层和三层处理模式进行数据库访问，但一般的 JDBC  架构由两层处理模式组成：</p>\n<ul>\n<li>JDBC API : 提供了应用程序对 JDBC  管理器的连接。</li>\n<li>JDBC Driver API : 提供了 JDBC  管理器对驱动程序连接。</li>\n</ul>\n<p>JDBC API  使用驱动程序管理器和数据库特定的驱动程序来提供异构（heterogeneous）数据库的透明连接。</p>\n<p>JDBC  驱动程序管理器可确保正确的驱动程序来访问每个数据源。该驱动程序管理器能够支持连接到多个异构数据库的多个并发的驱动程序。</p>\n<p>以下是结构图，其中显示了驱动程序管理器相对于在 JDBC  驱动程序和 Java  应用程序所处的位置。<br><img src=\"/Users/wangwc/Pictures/blogtmp/JDBC.jpg\" alt=\"JDBC\"></p>\n<h2 id=\"API-与类概述\"><a href=\"#API-与类概述\" class=\"headerlink\" title=\"API 与类概述\"></a>API 与类概述</h2><blockquote>\n<p>JDBC API 主要位于JDK 中的java.sql 包中（之后扩展的内容位于javax.sql 包中），主要包括（斜体代表接口，需驱动程序提供者来具体实现）：</p>\n<p><code>DriverManager</code> ：负责加载各种不同驱动程序（Driver ），并根据不同的请求，向调用者返回相应的数据库连接（Connection ）。<br><code>Driver</code> ：驱动程序，会将自身加载到DriverManager 中去，并处理相应的请求并返回相应的数据库连接（Connection ）。<br><code>Connection</code> ：数据库连接，负责进行与数据库间的通讯，SQL 执行以及事务处理都是在某个特定Connection 环境中进行的。可以产生用以执行SQL 的Statement 。<br><strong><code>Statement</code> ：用以执行SQL 查询和更新（针对静态SQL 语句和单次执行）。<br><code>PreparedStatement</code> ：用以执行包含动态参数的SQL 查询和更新（在服务器端编译，允许重复执行以提高效率）。<br><code>CallableStatement</code> ：用以调用数据库中的存储过程。</strong><br><code>SQLException</code> ：代表在数据库连接的创建和关闭和SQL语句的执行过程中发生了例外情况（即错误）。<br>摘自 wikipedia，Java数据库连接，<a href=\"https://zh.wikipedia.org/wiki/Java%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5\">https://zh.wikipedia.org/wiki/Java%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5</a></p>\n</blockquote>\n<p>除了以上 API ，JDBC  还提供了以下类：</p>\n<p><code>ResultSet</code>  : 在你使用语句对象执行 SQL  查询后，这些对象保存从数据获得的数据。它作为一个迭代器，让您可以通过它的数据来移动。</p>\n<h2 id=\"JDBC-使用基本思路\"><a href=\"#JDBC-使用基本思路\" class=\"headerlink\" title=\"JDBC 使用基本思路\"></a>JDBC 使用基本思路</h2><ol>\n<li>制作到数据库的连接。</li>\n<li>创建 SQL 或 MySQL 语句。</li>\n<li>执行 SQL 或 MySQL 查询数据库。</li>\n<li>查看和修改所产生的记录。</li>\n</ol>\n<h1 id=\"J2SE-通过-JDBC-连接数据库\"><a href=\"#J2SE-通过-JDBC-连接数据库\" class=\"headerlink\" title=\"J2SE 通过 JDBC 连接数据库\"></a>J2SE 通过 JDBC 连接数据库</h1><h2 id=\"前期准备\"><a href=\"#前期准备\" class=\"headerlink\" title=\"前期准备\"></a>前期准备</h2><ol>\n<li>安装完成 Java</li>\n<li>部署好数据库，以下采用的是 MySQL  数据库</li>\n<li>下载相关驱动，MySQL 的 JDBC 驱动为使用的是 mysql-connector-java-5.1.32-bin.jar ，<a href=\"https://dev.mysql.com/downloads/connector/j/3.1.html\">下载地址</a></li>\n</ol>\n<h2 id=\"创建-JDBC-应用程序\"><a href=\"#创建-JDBC-应用程序\" class=\"headerlink\" title=\"创建 JDBC 应用程序\"></a>创建 JDBC 应用程序</h2><ol>\n<li>导入数据包 . 需要包括含有需要进行数据库编程的JDBC类 的包。大多数情况下，使用 import java.sql.*  就可以了.</li>\n<li>注册JDBC驱动程序 . 需要初始化驱动程序，可以与数据库打开一个通信通道。</li>\n<li>打开连接. 需要使用DriverManager.getConnection()  方法创建一个Connection 对象，它代表与数据库的物理连接。</li>\n<li>执行查询 . 需要使用类型声明的对象建立并提交一个SQL 语句到数据库。</li>\n<li>从结果集中提取数据 . 要求使用适当的关于ResultSet.getXXX() 方法来检索结果集的数据。</li>\n<li>清理环境. 需要明确地关闭所有的数据库资源相对依靠JVM 的垃圾收集。</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/** STEP 1. Import required packages 导入数据包 */</span></div><div class=\"line\"><span class=\"keyword\">import</span> java.sql.*;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDBCExample</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">/** JDBC driver name and database URL</div><div class=\"line\">     *  定义 JDBC 驱动以及数据库地址，此处数据库为本地的 test */</span></div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String JDBC_DRIVER = <span class=\"string\">\"com.mysql.jdbc.Driver\"</span>;</div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String DB_URL = <span class=\"string\">\"jdbc:mysql://localhost/test\"</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/**  Database credentials</div><div class=\"line\">     *   数据库的账号、密码</div><div class=\"line\">     *   */</span></div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String USER = <span class=\"string\">\"root\"</span>;</div><div class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String PASS = <span class=\"string\">\"\"</span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</div><div class=\"line\">        Connection conn = <span class=\"keyword\">null</span>;</div><div class=\"line\">        Statement stmt = <span class=\"keyword\">null</span>;</div><div class=\"line\">        <span class=\"keyword\">try</span>&#123;</div><div class=\"line\">            <span class=\"comment\">/** STEP 2: Register JDBC driver</div><div class=\"line\">             * 加载 JDBC 驱动程序 Driver 至 DriverManager */</span></div><div class=\"line\">            Class.forName(JDBC_DRIVER);</div><div class=\"line\"></div><div class=\"line\">            <span class=\"comment\">/** STEP 3: Open a connection</div><div class=\"line\">             *  通过 DB_URL, 数据库账号和密码来获取相应的数据库连接 */</span></div><div class=\"line\">            System.out.println(<span class=\"string\">\"Connecting to database...\"</span>);</div><div class=\"line\">            conn = DriverManager.getConnection(DB_URL,USER,PASS);</div><div class=\"line\"></div><div class=\"line\">            <span class=\"comment\">/** STEP 4: Execute a query</div><div class=\"line\">             *  获取 connection 之后，可以创建 Statement 用来执行 SQL 语句</div><div class=\"line\">             *  其中 结果存储在 ResultSet 结果集 */</span></div><div class=\"line\">            System.out.println(<span class=\"string\">\"Creating statement...\"</span>);</div><div class=\"line\">            stmt = conn.createStatement();</div><div class=\"line\">            String sql;</div><div class=\"line\">            sql = <span class=\"string\">\"SELECT * FROM t_user\"</span>;</div><div class=\"line\">            ResultSet rs = stmt.executeQuery(sql);</div><div class=\"line\"></div><div class=\"line\">            <span class=\"comment\">/** STEP 5: Extract data from result set</div><div class=\"line\">             *  通过遍历结果集顺序访问数据</div><div class=\"line\">             *  具体是 getInt 还是 getString，请参考附录一：SQL 到 Java 的数据类型的映射*/</span></div><div class=\"line\">            <span class=\"keyword\">while</span>(rs.next())&#123;</div><div class=\"line\">                <span class=\"comment\">//Retrieve by column name</span></div><div class=\"line\">                <span class=\"keyword\">int</span> id  = rs.getInt(<span class=\"string\">\"id\"</span>);</div><div class=\"line\">                String name = rs.getString(<span class=\"string\">\"name\"</span>);</div><div class=\"line\">                <span class=\"keyword\">int</span> age = rs.getInt(<span class=\"string\">\"age\"</span>);</div><div class=\"line\">                <span class=\"keyword\">int</span> gender = rs.getInt(<span class=\"string\">\"gender\"</span>);</div><div class=\"line\"></div><div class=\"line\">                <span class=\"comment\">//Display values</span></div><div class=\"line\">                System.out.println(<span class=\"string\">\"ID: \"</span> + id + <span class=\"string\">\", Name: \"</span> + name</div><div class=\"line\">                        + <span class=\"string\">\", Age: \"</span> + age + <span class=\"string\">\", Gender: \"</span> + gender);</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"comment\">/** STEP 6: Clean-up environment</div><div class=\"line\">             * 清理环境，需要关闭结果集、Statement 以及数据库连接</div><div class=\"line\">             * 注意！关闭的顺序！*/</span></div><div class=\"line\">            rs.close();</div><div class=\"line\">            stmt.close();</div><div class=\"line\">            conn.close();</div><div class=\"line\">        &#125;<span class=\"keyword\">catch</span>(SQLException se)&#123;</div><div class=\"line\">            <span class=\"comment\">/** Handle errors for JDBC</div><div class=\"line\">             * 如果数据库操作失败，JDBC将抛出一个SQLException。</div><div class=\"line\">             * 一般来说，此类异常很少能够恢复，唯一能做的就是尽可能详细的打印异常日记。</div><div class=\"line\">             * 推荐的做法是将SQLException翻译成应用程序领域相关的异常（非强制处理异</div><div class=\"line\">             * 常）并最终回滚数据库和通知用户。*/</span></div><div class=\"line\">            se.printStackTrace();</div><div class=\"line\">        &#125;<span class=\"keyword\">catch</span>(Exception e)&#123;</div><div class=\"line\">            <span class=\"comment\">//Handle errors for Class.forName</span></div><div class=\"line\">            e.printStackTrace();</div><div class=\"line\">        &#125;<span class=\"keyword\">finally</span>&#123;</div><div class=\"line\">            <span class=\"comment\">//finally block used to close resources</span></div><div class=\"line\">            <span class=\"keyword\">try</span>&#123;</div><div class=\"line\">                <span class=\"keyword\">if</span>(stmt!=<span class=\"keyword\">null</span>)</div><div class=\"line\">                    stmt.close();</div><div class=\"line\">            &#125;<span class=\"keyword\">catch</span>(SQLException se2)&#123;</div><div class=\"line\">            &#125;<span class=\"comment\">// nothing we can do</span></div><div class=\"line\">            <span class=\"keyword\">try</span>&#123;</div><div class=\"line\">                <span class=\"keyword\">if</span>(conn!=<span class=\"keyword\">null</span>)</div><div class=\"line\">                    conn.close();</div><div class=\"line\">            &#125;<span class=\"keyword\">catch</span>(SQLException se)&#123;</div><div class=\"line\">                se.printStackTrace();</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"Goodbye!\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>以上一例为模板，以下例子仅填充<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\">Connection conn = <span class=\"keyword\">null</span>;</div><div class=\"line\">Statement stmt = <span class=\"keyword\">null</span>;</div><div class=\"line\">PreparedStatement pstmt = <span class=\"keyword\">null</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\tClass.forName(JDBC_DRIVER);</div><div class=\"line\">\tconn = DriverManager.getConnection(DB_URL, USER, PASS);</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"comment\">/* 在此填充代码 */</span></div><div class=\"line\"></div><div class=\"line\">&#125; <span class=\"keyword\">catch</span> (ClassNotFoundException e) &#123;</div><div class=\"line\">\te.printStackTrace();</div><div class=\"line\">&#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</div><div class=\"line\">\te.printStackTrace();</div><div class=\"line\">&#125; <span class=\"keyword\">finally</span> &#123;</div><div class=\"line\">\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> (stmt != <span class=\"keyword\">null</span>)</div><div class=\"line\">\t\t\tstmt.close();</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (SQLException se2) &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (conn != <span class=\"keyword\">null</span>)</div><div class=\"line\">\t\t\t\tconn.close();</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (SQLException se) &#123;</div><div class=\"line\">\t\t\tse.printStackTrace();</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h3 id=\"Example-1：executeQuery-，仅单行数据\"><a href=\"#Example-1：executeQuery-，仅单行数据\" class=\"headerlink\" title=\"Example 1：executeQuery()，仅单行数据\"></a>Example 1：executeQuery()，仅单行数据</h3><p>返回一个 ResultSet 对象。当希望得到一个结果集时使用该方法，如使用 SELECT 语句。<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//////// Example 1: statement, executeQuery</span></div><div class=\"line\">stmt = conn.createStatement();</div><div class=\"line\">String sql1 = <span class=\"string\">\"SELECT COUNT(DISTINCT `name`) AS 'cnt' FROM `user`\"</span>;</div><div class=\"line\">ResultSet rs = stmt.executeQuery(sql1);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">while</span> (rs.next()) &#123;</div><div class=\"line\">\t<span class=\"keyword\">int</span> cnt1 = rs.getInt(<span class=\"number\">1</span>); <span class=\"comment\">// 此处的 column，第一列下标为 1，而非 0</span></div><div class=\"line\">\t<span class=\"keyword\">int</span> cnt2 = rs.getInt(<span class=\"string\">\"cnt\"</span>);</div><div class=\"line\">\tSystem.out.println(<span class=\"string\">\"count: \"</span> + cnt1 + <span class=\"string\">\", \"</span> + cnt2);</div><div class=\"line\">&#125;</div><div class=\"line\">rs.close();</div></pre></td></tr></table></figure></p>\n<h3 id=\"Example-2：executeUpdate\"><a href=\"#Example-2：executeUpdate\" class=\"headerlink\" title=\"Example 2：executeUpdate()\"></a>Example 2：executeUpdate()</h3><p>返回执行 SQL 语句影响的行的数目。使用该方法来执行 SQL 语句，得到一些受影响的行的数目，例如，INSERT，UPDATE 或 DELETE 语句<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//////// Example 2: statement, executeUpdate</span></div><div class=\"line\">String sql2 = <span class=\"string\">\"INSERT INTO `user`(name, age) VALUES ('noname', 30)\"</span>;</div><div class=\"line\"><span class=\"keyword\">int</span> ret2 = stmt.executeUpdate(sql2);</div></pre></td></tr></table></figure></p>\n<h3 id=\"Example-3：execute\"><a href=\"#Example-3：execute\" class=\"headerlink\" title=\"Example 3：execute()\"></a>Example 3：execute()</h3><p>如果 ResultSet 对象可以被检索，则返回的布尔值为 true ，否则返回 false 。当需要使用真正的动态 SQL 时，可以使用这个方法来执行 SQL DDL 语句。<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//////// Example 3: statement, execute</span></div><div class=\"line\">String sql3 = <span class=\"string\">\"CREATE TABLE tmp(id int,name VARCHAR(255))\"</span>;</div><div class=\"line\"><span class=\"keyword\">boolean</span> ret3 = stmt.execute(sql3);</div></pre></td></tr></table></figure></p>\n<h3 id=\"Example-4：PrepareStatement\"><a href=\"#Example-4：PrepareStatement\" class=\"headerlink\" title=\"Example 4：PrepareStatement\"></a>Example 4：PrepareStatement</h3><p>使用问号作为参数的标示。进行参数设置与大部分Java API中下标的使用方法不同，字段的下标从1开始，1代表第一个问号<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/////// Example 4: preparedStatement</span></div><div class=\"line\">String sql4 = <span class=\"string\">\"SELECT * FROM `user` WHERE name=? AND age=?\"</span>;</div><div class=\"line\">pstmt = conn.prepareStatement(sql4);</div><div class=\"line\">pstmt.setString(<span class=\"number\">1</span>, <span class=\"string\">\"test\"</span>);</div><div class=\"line\">pstmt.setInt(<span class=\"number\">2</span>, <span class=\"number\">10</span>);</div><div class=\"line\">ResultSet rs4 = pstmt.executeQuery();</div><div class=\"line\"><span class=\"keyword\">while</span> (rs4.next()) &#123;</div><div class=\"line\">\tString name = rs4.getString(<span class=\"string\">\"name\"</span>);</div><div class=\"line\">\t<span class=\"keyword\">int</span> age = rs4.getInt(<span class=\"string\">\"age\"</span>);</div><div class=\"line\">\tSystem.out.println(<span class=\"string\">\"Name: \"</span> + name + <span class=\"string\">\", \"</span> + <span class=\"string\">\"Age: \"</span> + age);</div><div class=\"line\">&#125;</div><div class=\"line\">rs4.close();</div></pre></td></tr></table></figure></p>\n<h3 id=\"Example-5：JDBC-下的事务\"><a href=\"#Example-5：JDBC-下的事务\" class=\"headerlink\" title=\"Example 5：JDBC 下的事务\"></a>Example 5：JDBC 下的事务</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">///////// Example 5: 事务与回滚 transaction and rollback</span></div><div class=\"line\"><span class=\"keyword\">boolean</span> autoCommitDefault = <span class=\"keyword\">false</span>;</div><div class=\"line\">Savepoint savepoint1 = <span class=\"keyword\">null</span>;</div><div class=\"line\">Savepoint savepoint2 = <span class=\"keyword\">null</span>;</div><div class=\"line\"><span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\tClass.forName(JDBC_DRIVER);</div><div class=\"line\">\tconn = DriverManager.getConnection(DB_URL, USER, PASS);</div><div class=\"line\"></div><div class=\"line\">\tautoCommitDefault = conn.getAutoCommit();</div><div class=\"line\">\t<span class=\"comment\">// 关闭自动提交，数据库默认时，是自动提交的</span></div><div class=\"line\">\tconn.setAutoCommit(<span class=\"keyword\">false</span>);</div><div class=\"line\">\tstmt = conn.createStatement();</div><div class=\"line\"></div><div class=\"line\">\tString sql5 = <span class=\"string\">\"SELECT * FROM `user` WHERE age=10\"</span>;</div><div class=\"line\">\tString sql6 = <span class=\"string\">\"INSERT INTO `user`(name, age) VALUES ('name1',1),('name2', 2)\"</span>;</div><div class=\"line\">\tString sql7 = <span class=\"string\">\"UPDATE `user` SET `name`='newname' WHERE age=10\"</span>;</div><div class=\"line\">\tstmt.executeQuery(sql5);</div><div class=\"line\">\tsavepoint1 = conn.setSavepoint(<span class=\"string\">\"Savepoint1\"</span>);</div><div class=\"line\">\tstmt.executeUpdate(sql6);</div><div class=\"line\">\tsavepoint2 = conn.setSavepoint(<span class=\"string\">\"Savepoint2\"</span>);</div><div class=\"line\">\tstmt.executeUpdate(sql7);</div><div class=\"line\">\tconn.commit();</div><div class=\"line\"></div><div class=\"line\">&#125; <span class=\"keyword\">catch</span> (Throwable e) &#123;</div><div class=\"line\">\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t<span class=\"comment\">// 回滚, 至 savepoint2. savepoint 非必须</span></div><div class=\"line\">\t\tconn.rollback(savepoint2);</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (Throwable ignore) &#123;&#125;</div><div class=\"line\">\t<span class=\"keyword\">throw</span> e;</div><div class=\"line\">&#125; <span class=\"keyword\">finally</span> &#123;</div><div class=\"line\">\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t<span class=\"comment\">// 将 commit 设回默认值</span></div><div class=\"line\">\t\tconn.setAutoCommit(autoCommitDefault);</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (Throwable ignore) &#123;&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> (stmt != <span class=\"keyword\">null</span>)</div><div class=\"line\">\t\t\tstmt.close();</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (SQLException se2) &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (conn != <span class=\"keyword\">null</span>)</div><div class=\"line\">\t\t\t\tconn.close();</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (SQLException se) &#123;</div><div class=\"line\">\t\t\tse.printStackTrace();</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"Example-6：JDBC-下的存储过程\"><a href=\"#Example-6：JDBC-下的存储过程\" class=\"headerlink\" title=\"Example 6：JDBC 下的存储过程\"></a>Example 6：JDBC 下的存储过程</h3><p><strong> TODO </strong><br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/*</div><div class=\"line\"> * 有IN 类型的参数输入 和Out类型的参数输出\t</div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">inOutTest</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">\tConnection connection = <span class=\"keyword\">null</span>;</div><div class=\"line\">\tStatement statement = <span class=\"keyword\">null</span>;</div><div class=\"line\">\tResultSet resultSet = <span class=\"keyword\">null</span>;</div><div class=\"line\">\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t</div><div class=\"line\">\t\tClass.forName(<span class=\"string\">\"oracle.jdbc.driver.OracleDriver\"</span>).newInstance();</div><div class=\"line\">\t\t</div><div class=\"line\">\t\tDriver driver = DriverManager.getDriver(URL);</div><div class=\"line\">\t\tProperties props = <span class=\"keyword\">new</span> Properties();</div><div class=\"line\">\t\tprops.put(<span class=\"string\">\"user\"</span>, USER_NAME);</div><div class=\"line\">\t\tprops.put(<span class=\"string\">\"password\"</span>, PASSWORD);</div><div class=\"line\">\t\t</div><div class=\"line\">\t\tconnection = driver.connect(URL, props);</div><div class=\"line\">\t\t</div><div class=\"line\">\t\t<span class=\"comment\">//获得Statement对象,这里使用了事务机制，如果创建存储过程语句失败或者是执行compile失败，回退</span></div><div class=\"line\">\t\tconnection.setAutoCommit(<span class=\"keyword\">false</span>);</div><div class=\"line\">\t\tstatement = connection.createStatement();</div><div class=\"line\">\t\tString procedureString = <span class=\"string\">\"CREATE OR REPLACE PROCEDURE get_job_min_salary_proc(\"</span></div><div class=\"line\">\t\t\t\t\t\t\t\t\t+<span class=\"string\">\"input_job_id IN VARCHAR2,\"</span></div><div class=\"line\">\t\t\t\t\t\t\t\t\t+<span class=\"string\">\"output_salary OUT number) AS \"</span></div><div class=\"line\">\t\t\t\t\t\t\t\t\t+<span class=\"string\">\"BEGIN \"</span></div><div class=\"line\">\t\t\t\t\t\t\t\t\t+<span class=\"string\">\"SELECT min_salary INTO output_salary FROM jobs WHERE job_id = input_job_id; \"</span></div><div class=\"line\">\t\t\t\t\t\t\t\t\t+<span class=\"string\">\"END   get_job_min_salary_proc;\"</span>;</div><div class=\"line\">\t\t<span class=\"comment\">//1 创建存储过程,JDBC 数据库会编译存储过程</span></div><div class=\"line\">\t\tstatement.execute(procedureString);</div><div class=\"line\">\t\t<span class=\"comment\">//成功则提交</span></div><div class=\"line\">\t\tconnection.commit();</div><div class=\"line\">\t\t<span class=\"comment\">//2.创建callableStatement</span></div><div class=\"line\">\t    CallableStatement callableStatement = connection.prepareCall(<span class=\"string\">\"CALL get_job_min_salary_proc(?,?)\"</span>);</div><div class=\"line\">\t    <span class=\"comment\">//3，设置in参数</span></div><div class=\"line\">\t    callableStatement.setString(<span class=\"number\">1</span>, <span class=\"string\">\"AD_PRES\"</span>);</div><div class=\"line\">\t    <span class=\"comment\">//4.注册输出参数</span></div><div class=\"line\">\t    callableStatement.registerOutParameter(<span class=\"number\">2</span>, Types.NUMERIC);</div><div class=\"line\">\t    <span class=\"comment\">//5.执行语句</span></div><div class=\"line\">\t    callableStatement.execute();</div><div class=\"line\">\t    </div><div class=\"line\">\t    BigDecimal salary = callableStatement.getBigDecimal(<span class=\"number\">2</span>);</div><div class=\"line\">\t    System.out.println(salary);</div><div class=\"line\">\t\t</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (ClassNotFoundException e) &#123;</div><div class=\"line\">\t\tSystem.out.println(<span class=\"string\">\"加载Oracle类失败！\"</span>);</div><div class=\"line\">\t\te.printStackTrace();</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\tconnection.rollback();</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">catch</span> (SQLException e1) &#123;</div><div class=\"line\">\t\t\te1.printStackTrace();</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\te.printStackTrace();</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (InstantiationException e) &#123;</div><div class=\"line\">\t\te.printStackTrace();</div><div class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (IllegalAccessException e) &#123;</div><div class=\"line\">\t\te.printStackTrace();</div><div class=\"line\">\t&#125;<span class=\"keyword\">finally</span>&#123;</div><div class=\"line\">\t\t    <span class=\"comment\">//使用完成后管理链接，释放资源，释放顺序应该是： ResultSet -&gt;Statement -&gt;Connection</span></div><div class=\"line\">\t\t\t</div><div class=\"line\">\t\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\t\tstatement.close();</div><div class=\"line\">\t\t\t&#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</div><div class=\"line\">\t\t\t\te.printStackTrace();</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t\t</div><div class=\"line\">\t\t\t<span class=\"keyword\">try</span> &#123;</div><div class=\"line\">\t\t\t\tconnection.close();</div><div class=\"line\">\t\t\t&#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</div><div class=\"line\">\t\t\t\te.printStackTrace();</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n"},{"title":"new article","date":"2016-10-09T16:39:29.000Z","_content":"\n## My First Hexo Article\n\n```java\nclass Hello {\n\tpublish static void main(String[] args) {\n\t\tSystem.out.println(\"hello world!!\");\n\t\treturn;\n\t}\n}\n```\n\ntest `code` inline\n\n\n","source":"_posts/new-article.md","raw":"---\ntitle: new article\ndate: 2016-10-10 00:39:29\ncategories:\n- day\ntags:\n- test\n- markdown\n---\n\n## My First Hexo Article\n\n```java\nclass Hello {\n\tpublish static void main(String[] args) {\n\t\tSystem.out.println(\"hello world!!\");\n\t\treturn;\n\t}\n}\n```\n\ntest `code` inline\n\n\n","slug":"new-article","published":1,"updated":"2016-10-11T17:22:25.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciua0m28600060inuwwyzgzc6","content":"<h2 id=\"My-First-Hexo-Article\"><a href=\"#My-First-Hexo-Article\" class=\"headerlink\" title=\"My First Hexo Article\"></a>My First Hexo Article</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Hello</span> </span>&#123;</div><div class=\"line\">\t<span class=\"function\">publish <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</div><div class=\"line\">\t\tSystem.out.println(<span class=\"string\">\"hello world!!\"</span>);</div><div class=\"line\">\t\t<span class=\"keyword\">return</span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>test <code>code</code> inline</p>\n","excerpt":"","more":"<h2 id=\"My-First-Hexo-Article\"><a href=\"#My-First-Hexo-Article\" class=\"headerlink\" title=\"My First Hexo Article\"></a>My First Hexo Article</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Hello</span> </span>&#123;</div><div class=\"line\">\t<span class=\"function\">publish <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</div><div class=\"line\">\t\tSystem.out.println(<span class=\"string\">\"hello world!!\"</span>);</div><div class=\"line\">\t\t<span class=\"keyword\">return</span>;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>test <code>code</code> inline</p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"ciua0m28600060inuwwyzgzc6","category_id":"ciua0m28a00080inu6qh3b9s7","_id":"ciua0m28e000d0inusd035nkw"}],"PostTag":[{"post_id":"ciua0m27k00010inu72jc5afu","tag_id":"ciua0m27z00040inuduxd0zrl","_id":"ciua0m28a00090inu5m6hlha5"},{"post_id":"ciua0m28600060inuwwyzgzc6","tag_id":"ciua0m28b000a0inuwhq69uk6","_id":"ciua0m28e000e0inu9dmdtmm3"},{"post_id":"ciua0m28600060inuwwyzgzc6","tag_id":"ciua0m28e000c0inudt8ophtf","_id":"ciua0m28f000f0inuq5hcy3sk"},{"post_id":"ciua0m28300050inuik74wfp0","tag_id":"ciua2s632000074nub49mj8xi","_id":"ciua2s636000174nu5cdjh3vy"},{"post_id":"ciua0m28300050inuik74wfp0","tag_id":"ciua0m27z00040inuduxd0zrl","_id":"ciua2s636000274nu939gqzp9"}],"Tag":[{"name":"Spring","_id":"ciua0m27z00040inuduxd0zrl"},{"name":"JDBC, Spring","_id":"ciua0m28800070inu6prpf7is"},{"name":"test","_id":"ciua0m28b000a0inuwhq69uk6"},{"name":"markdown","_id":"ciua0m28e000c0inudt8ophtf"},{"name":"JDBC","_id":"ciua2s632000074nub49mj8xi"}]}}